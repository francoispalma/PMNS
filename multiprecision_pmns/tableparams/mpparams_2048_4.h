#define N 9
#define NBCHUNKS 4
#define LAMBDA 2
#define RHOver2 59

static const uint64_t RHOhi = 3195058040060681u;

static const int64_t M[4][17] = { {
		249298733309135112, 379187211939867856, 259950737768842018, 471018760682323404, 128260811061921484, 411334225330982032, 149176608021028994, 21200355210674584, 268119384048828565, 124649366654567556, 477823982121645672, 418205745036132753, 523739756492873446, 352360781682672486, 493897488817202760, 362818680162226241, 10600177605337292
	}, {
		37262622230674242, 76134800718367761, 388466430314307757, 495663580702347871, 203192534970838449, 413079770621353325, 106146697591055661, 293977285198821280, 325035853848229236, 18631311115337121, 326297776510895624, 194233215157153878, 536062166502885679, 389826643637130968, 494770261462388406, 341303724947239574, 435219018751122384
	}, {
		121711588185274742, 344289757988143361, 310803867689223496, 384824794239151749, 226791459838629843, 120792824136209119, 317538089611312959, 192828931099267045, 51152573091837359, 349086170244349115, 460375255145783424, 155401933844611748, 480642773271287618, 113395729919314921, 60396412068104559, 158769044805656479, 384644841701345266
	}, {
695039950711729, 373238001294651, 603046576425570, -1392263676958135, 1607454589105942, 139261187958316, -160148325659848, -8028994093339, 1411634777913832, 347519975355864, 186619000647325, 301523288212785, -696131838479068, 803727294552971, 69630593979158, -80074162829924, -4014497046670
} };

static const int64_t M1[] = {
487001799712464672, 106336317209236088, 4886300750386350, 363268701892226312, 108886302271269848, 49809486257213458, 80750126047994338, 335173001161574148, 572599371857216625, 243500899856232336, 53168158604618044, 290673526526904919, 181634350946113156, 54443151135634924, 24904743128606729, 40375063023997169, 167586500580787074
};

static inline void mtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/3)

static inline void m1toep10(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1SCHOOLBOOK(N/3)


static inline void toeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP33TOP(N, mtoep10)

static inline void ptoeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	pTOEP33TOP(N, mtoep10)

static inline void m1toep20(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP33TOP(N, m1toep10)


static inline void mtoeplitz_vm0(__int128* restrict rop, const int64_t* restrict vect)
{
	toeplitz_vm(rop, vect, M[0]);
}



static inline void mtoeplitz_vm1(__int128* restrict rop, const int64_t* restrict vect)
{
	toeplitz_vm(rop, vect, M[1]);
}



static inline void mtoeplitz_vm2(__int128* restrict rop, const int64_t* restrict vect)
{
	toeplitz_vm(rop, vect, M[2]);
}



static inline void mtoeplitz_vm3(__int128* restrict rop, const int64_t* restrict vect)
{
	toeplitz_vm(rop, vect, M[3]);
}



static inline void m1toeplitz_vm(int64_t* restrict rop, const __int128* restrict vect)
{
	int64_t v[N];
	for(int i = 0; i < N; i++)
		v[i] = vect[i];
	m1toep20(rop, v, M1);
}


void (* const multbym[4]) (__int128* restrict rop, const int64_t* restrict vect) = { mtoeplitz_vm0, mtoeplitz_vm1, mtoeplitz_vm2, mtoeplitz_vm3 };

