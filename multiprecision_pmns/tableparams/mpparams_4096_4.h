#define N 18
#define NBCHUNKS 4
#define LAMBDA 2
#define RHOver2 59

static const uint64_t RHOhi = 6338904590041021u;

static const int64_t M[4][35] = { {
		181829447435884382, 244528676375244132, 324141977555049564, 254053774781364206, 431973655643381306, 421579102599653528, 365737551032212370, 362156930332495438, 515738498638232772, 8597047581746108, 369593825189710282, 457087343821464908, 526939095955595510, 466172958315117906, 215318125967953494, 55413057228875744, 291067774460459850, 516209357630633509, 379145099869653935, 122264338187622066, 162070988777524782, 127026887390682103, 504217203973402397, 499019927451538508, 182868775516106185, 181078465166247719, 546099625470828130, 292528899942584798, 184796912594855141, 228543671910732454, 551699924129509499, 233086479157558953, 395889439135688491, 315936904766149616, 433764263381941669
	}, {
		536333604042675883, 557100288738784778, 62342370152535356, 149753901614976812, 478232782266920331, 405408600188582985, 162406364114130944, 205790530579714938, 196928166385034191, 439811186998681809, 324751255247823092, 33572156886291046, 334934807751743077, 261062268312132622, 62687207273102331, 526507616164631715, 129175787568450241, 479500250219865224, 268166802021337941, 278550144369392389, 319401561227979422, 363107326959200150, 239116391133460165, 202704300094291492, 81203182057065472, 102895265289857469, 98464083192517095, 219905593499340904, 162375627623911546, 16786078443145523, 167467403875871538, 418761510307778055, 319573979788262909, 263253808082315857, 64587893784225120
	}, {
		565989369104756900, 298908558642334388, 208390988661951247, 93015659197936609, 183920256686354510, 233040878416927702, 164156132767594242, 213651809349222832, 389362499983434882, 546599788328642564, 243413485440823846, 8371638925490252, 453100162126948484, 324813148479025955, 19025962906262857, 533000336013565784, 312942233918781596, 509756704273723131, 282994684552378450, 437684655472878938, 104195494330975623, 46507829598968304, 380190504494888999, 404750815360175595, 82078066383797121, 106825904674611416, 482911626143429185, 273299894164321282, 409937118872123667, 292416195614456870, 514780457215185986, 162406574239512977, 9512981453131428, 554730544158494636, 444701493111102542
	}, {
186030629429182, -744271432900343, -1289179852603476, -290989565901676, 17420959115391, -1081521292254643, -402653720009482, -1331737213135738, -78644642508221, -3074935268873572, 695365976168739, 358405472548135, -757313941225475, 374939192235754, -482434923517018, -671033299489623, 833340782659745, 7591015505831, 93015314714591, -372135716450172, -644589926301738, -145494782950838, 8710479557695, -540760646127322, -201326860004741, -665868606567869, -39322321254111, -1537467634436786, 347682988084369, 179202736274067, -378656970612738, 187469596117877, -241217461758509, -335516649744812, 416670391329872
} };

static const int64_t M1[] = {
203974542694305166, 280283866347305982, 205582458085279774, 159838292682428896, 353388476347842224, 564408823285624116, 222802974156711346, 556288643080838824, 35252512073756896, 255613638833627724, 40785709329212686, 342294233641583666, 454011584614389594, 310359390970723542, 405998736102223128, 558770621437808926, 125312855796516312, 272197370044034903, 101987271347152583, 140141933173652991, 391021605194351631, 79919146341214448, 176694238173921112, 570434787794523802, 399631863230067417, 566374697692131156, 17626256036878448, 127806819416813862, 308623230816318087, 171147116820791833, 515236168458906541, 155179695485361771, 202999368051111564, 567615686870616207, 62656427898258156
};

static inline void mtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/3)

static inline void m1toep10(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1SCHOOLBOOK(N/3)


static inline void toeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP33TOP(N, mtoep10)

static inline void ptoeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	pTOEP33TOP(N, mtoep10)

static inline void m1toep20(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP33TOP(N, m1toep10)


static inline void mtoeplitz_vm0(__int128* restrict rop, const int64_t* restrict vect)
{
	toeplitz_vm(rop, vect, M[0]);
}



static inline void mtoeplitz_vm1(__int128* restrict rop, const int64_t* restrict vect)
{
	toeplitz_vm(rop, vect, M[1]);
}



static inline void mtoeplitz_vm2(__int128* restrict rop, const int64_t* restrict vect)
{
	toeplitz_vm(rop, vect, M[2]);
}



static inline void mtoeplitz_vm3(__int128* restrict rop, const int64_t* restrict vect)
{
	toeplitz_vm(rop, vect, M[3]);
}



static inline void m1toeplitz_vm(int64_t* restrict rop, const __int128* restrict vect)
{
	int64_t v[N];
	for(int i = 0; i < N; i++)
		v[i] = vect[i];
	m1toep20(rop, v, M1);
}


void (* const multbym[4]) (__int128* restrict rop, const int64_t* restrict vect) = { mtoeplitz_vm0, mtoeplitz_vm1, mtoeplitz_vm2, mtoeplitz_vm3 };

