#define N 80
#define NBCHUNKS 2
#define LAMBDA 2
#define RHOver2 56

static const uint64_t RHOhi = 2849334650599326u;

static const int64_t M[2][159] = { {
		40670606899608198, 52131042925251644, 36597860010036994, 10020999714508064, 44385100243620400, 823085005954948, 50432517111638140, 35397164884676520, 27750680048333418, 12880411607875072, 70410752592300518, 57718989628207372, 63638312183367538, 7864792520146126, 14173357285924930, 4924116283178114, 24257778774897008, 13743957971207894, 1709775278014930, 34605061396885400, 17019759668040276, 50710696957402800, 17956200419333458, 17058883848707206, 1482803852620274, 54636554429558850, 5033620322107680, 40333293481444552, 54810662951021476, 45801516048041360, 33346179034340370, 24201060782977812, 66609772451647300, 40374697811573566, 67229094937231892, 70944407306004874, 55302136779852158, 20960007936821968, 32317984072104906, 31152085982661212, 31961492418133484, 1036307832672186, 27977929375985090, 39882868801303876, 9089844401461394, 47892910676038940, 59100728494206108, 33903335017419326, 67374313352851578, 58496037792462928, 7758228886471006, 27600462393321234, 56138562762709760, 1128533322425750, 38581527752983780, 13538974334235598, 6975347328847582, 69175028924055810, 39071965225251438, 39104349911801524, 37145213100647306, 64709635573168584, 70003841276560488, 63112748422467516, 37281285930694418, 15992290532050252, 13150974364797952, 51301284769315490, 31986061597736416, 48838523103665988, 12626611908495536, 52492819481622930, 67005470143556284, 54634589766798106, 27420112344496516, 66314619831634644, 17509297362748878, 15230461337778794, 932784621496108, 51263890498171559, 56364100468768067, 26065521462625822, 18298930005018497, 5010499857254032, 58221347140774168, 411542502977474, 61245055574783038, 17698582442338260, 49904137043130677, 42469002822901504, 35205376296150259, 28859494814103686, 31819156091683769, 39961193279037031, 43115475661926433, 38490855160553025, 12128889387448504, 6871978985603947, 36883684657971433, 17302530698442700, 44538676852984106, 25355348478701400, 8978100209666729, 44558238943317571, 741401926310137, 27318277214779425, 38545607180017808, 56195443759686244, 63434128494474706, 58929555042984648, 52701886536134153, 12100530391488906, 33304886225823650, 56216145924750751, 69643344487579914, 35472203653002437, 63679865408890047, 46508800987374952, 52187789055016421, 15576042991330606, 52009543228030710, 36546950935300061, 50017761706956513, 55970231419615906, 40573719219694665, 59975252356983438, 29550364247103054, 52980464527673631, 33687156676425789, 29248018896231464, 3879114443235503, 13800231196660617, 28069281381354880, 564266661212875, 19290763876491890, 42798284186081767, 39516470683387759, 34587514462027905, 19535982612625719, 55580971974864730, 18572606550323653, 32354817786584292, 35001920638280244, 31556374211233758, 18640642965347209, 44024942284989094, 42604284201362944, 25650642384657745, 15993030798868208, 24419261551832994, 6313305954247768, 26246409740811465, 33502735071778142, 63346091902363021, 13710056172248258, 33157309915817322, 8754648681374439, 7615230668889397, 36495189329712022
	}, {
-40768655350629, 26415637731638, 49552779329580, 2900320618060, -209179629290441, -26971230481290, 134663931082513, -20540223336584, 42237141226211, -56797283328595, 48450751877722, 54282492138658, -29930384515602, -3295359366017, -43779493574229, -35366497038711, -36092045089472, 19500466342014, -80945881670733, 170696953755398, 39362340270715, -165344904941276, -380069273532, -23143394485815, 16045916870556, -96923208722802, 43974051224085, 86934535209713, -202278674433769, -53077278188669, -140974415957497, 35766113201854, -154167196162256, -142052378772817, 46676806801887, -52297393343820, 169238082471997, 12605589876185, -42866233424165, 38212623658314, -340906579539, -41518084220761, 133859808152925, 100304902487725, 31469296203899, 11541251391849, -85979598207040, -181652271760865, 127843459381172, -30827464293968, 27524210596534, 40660092154474, -100801565355074, 84333134615246, 139352540609598, 145128258960875, 126953547863509, -129409430925804, -172438318763186, -82627106867061, 118905686508156, -1299390342760, -6036444699840, 87549539655604, 67928985786272, -24209197079235, -68538766714433, -4599543882326, 201790382096934, 43537047155040, -16104116402320, 167639630700658, -80026443473330, -44094322359635, -93403990620902, 110358087167550, -56933306843476, 29120745268, 7659196850293, -8772488287701, -20384327675315, 13207818865819, 24776389664790, 1450160309030, -104589814645221, -13485615240645, 67331965541256, -10270111668292, 21118570613105, -28398641664298, 24225375938861, 27141246069329, -14965192257801, -1647679683009, -21889746787115, -17683248519356, -18046022544736, 9750233171007, -40472940835367, 85348476877699, 19681170135357, -82672452470638, -190034636766, -11571697242908, 8022958435278, -48461604361401, 21987025612042, 43467267604856, -101139337216885, -26538639094335, -70487207978749, 17883056600927, -77083598081128, -71026189386409, 23338403400943, -26148696671910, 84619041235998, 6302794938092, -21433116712083, 19106311829157, -170453289770, -20759042110381, 66929904076462, 50152451243862, 15734648101949, 5770625695924, -42989799103520, -90826135880433, 63921729690586, -15413732146984, 13762105298267, 20330046077237, -50400782677537, 42166567307623, 69676270304799, 72564129480437, 63476773931754, -64704715462902, -86219159381593, -41313553433531, 59452843254078, -649695171380, -3018222349920, 43774769827802, 33964492893136, -12104598539618, -34269383357217, -2299771941163, 100895191048467, 21768523577520, -8052058201160, 83819815350329, -40013221736665, -22047161179818, -46701995310451, 55179043583775, -28466653421738, 14560372634, 3829598425146
} };

static const int64_t M1[] = {
48156873148581274, 40233434196133014, 30726157014749392, 51820433300421550, 47008433688134936, 3681876549576056, 49320847254692826, 11693411006196502, 58408476431928308, 46218060086436712, 55662396048466718, 11130463953577628, 23966662703726198, 48082131798450500, 34484103072017200, 9477265091820654, 71438717580276006, 29192104424405858, 65274295861042592, 28195793060135272, 59082029464703232, 60372062642698826, 63539613158745294, 17500684633741272, 63520840403077202, 33396268132829624, 40465799166277948, 27466726009287082, 4779857939652632, 53465759665689886, 51396583821074748, 27713145516341232, 62269801923496658, 4789203219743552, 46189509454941012, 15720172047981516, 59594252470769468, 34380120919732824, 65275266323376370, 7747177942518286, 51237730576789612, 16309334361870728, 38169679171825108, 38939265591996492, 13096536249356120, 43470576462613024, 23788834605305040, 4399016698696722, 51788233699715012, 6443791630071290, 46931756520625480, 49865178230967488, 24900728944818882, 440748200779282, 61437491474174044, 11511802084767072, 61599003630752202, 62939496675561344, 53690154096412120, 10953375004920658, 67475842417520294, 51358452618148290, 2341244734035552, 13251767236154978, 34038190502540578, 39232139364565386, 24601629619749148, 38553388714116964, 47079756063081664, 26933015761701274, 9403399512297164, 68614674876619414, 65034585984060600, 71938962581105394, 22187121909893392, 14159924891590038, 15349999211591598, 15431103052981012, 28325988864293366, 53059312320155025, 60107233593254605, 20116717098066507, 15363078507374696, 25910216650210775, 59533013863031436, 1840938274788028, 24660423627346413, 5846705503098251, 29204238215964154, 59137827062182324, 63859995043197327, 5565231976788814, 48012128370827067, 60069862918189218, 17242051536008600, 40767429564874295, 71748155809101971, 14596052212202929, 32637147930521296, 50126693549031604, 65569811751315584, 66214828340313381, 67798603598336615, 44779139335834604, 67789217220502569, 16698134066414812, 20232899583138974, 13733363004643541, 38418725988790284, 62761676851808911, 61727088929501342, 49885369777134584, 31134900961748329, 2394601609871776, 23094754727470506, 43888883042954726, 29797126235384734, 53218857478830380, 68666430180652153, 39902385990223111, 61647662307358774, 44183464199899332, 55113636604876522, 55498429814962214, 6548268124678060, 21735288231306512, 47923214321616488, 2199508349348361, 61922913868821474, 39250692833999613, 59494675279276708, 60961386134447712, 12450364472409441, 220374100389641, 30718745737087022, 5755901042383536, 66828298834340069, 67498545356744640, 62873874067170028, 41505484521424297, 69766718227724115, 61708023328038113, 1170622367017776, 6625883618077489, 17019095251270289, 19616069682282693, 12300814809874574, 55305491376022450, 23539878031540832, 49495304899814605, 4701699756148582, 34307337438309707, 32517292992030300, 35969481290552697, 47122357973910664, 7079962445795019, 43703796624759767, 43744348545454474, 14162994432146683
};

static const int64_t M0m0m1[79] = { -24402608050634583, -25029213629953636, 9678999370966593, 34872368944049844, -49131502739312774, 47481368173061466, -2144327080576930, 16204752575081066, 17470176309720901, 16027034969561424, -27447147409679253, -1259032420782452, 24319406671025991, -38832659956611281, -4533947908942653, -24951880826317427, -5153542058600922, 62303049938451863, 2188280567280005, 21801819213358824, -7393463752336800, 39354287094467184, 61025741066893759, 18554509479149945, 36539884004384281, -11325986682729173, -25394632815219856, -4894158990370754, -31448066896738290, -10091031939318660, -40075274627638617, 40392289090134024, 33700583917732634, -1581556157952645, -42223232143083398, 30842416178632207, -46170568046141169, -31278339649596158, -51255004433520313, 35687847506840953, 4354557240737357, -10481429472674239, -31718831701938016, -50959731562361874, 17647627921079503, -59563709854005964, 31694691327679984, -35281882085335371, 16216980366704888, 13220983926670040, 31326261852914756, 15059263617443069, 3749874710328889, 39396926617824156, 23824711785434543, -4307429025528742, -27387581295939255, -27715535476423958, 17347702045345714, -38278441276422030, 25966070302660453, -6999469307882892, -26023820428613515, 13001864732083813, -17899241039037072, -16706665070209669, -4058677021345136, 30544801375028499, 47441097695606498, 34510293491151654, 46388580581886385, -14145879349322559, -197848845954492, -7129945977612270, 55933288315331656, 2314893737185115, 54925216727515608, 38893570318485555, 15692599725304399 };

static const int64_t M0m0m2[79] = { -8709114481474714, -51094735092579458, -8619930634051904, 29861869086795812, -35295255842159006, 47069825670083992, 8668211382567968, -1493829867257194, 39623633304518160, 45615626184587856, -62652523705829512, -30118527234886138, -7499749420657778, -6736259197720376, 24408170467058850, 8614858051057484, -17282431446049426, 55431070952847916, 37362189947236508, 4499288514916124, 20125453432607030, 13998938615765784, 52047640857227030, 46053864573760310, 35798482078074144, -38644263897508598, 8117354042690272, 10967991287870938, -22824601353285060, 3037007055624628, -20719567125844834, 28291758698645118, 395697691908984, 14259891955224540, -39808982592735376, -4629787474370230, -37792839417103280, -5729546599043174, -31385199450608798, 20111804515510347, 24402608050634583, 25029213629953636, -9678999370966593, -34872368944049844, 49131502739312774, -47481368173061466, 2144327080576930, -16204752575081066, -17470176309720901, -16027034969561424, 27447147409679253, 1259032420782452, -24319406671025991, 38832659956611281, 4533947908942653, 24951880826317427, 5153542058600922, -62303049938451863, -2188280567280005, -21801819213358824, 7393463752336800, -39354287094467184, -61025741066893759, -18554509479149945, -36539884004384281, 11325986682729173, 25394632815219856, 4894158990370754, 31448066896738290, 10091031939318660, 40075274627638617, -40392289090134024, -33700583917732634, 1581556157952645, 42223232143083398, -30842416178632207, 46170568046141169, 31278339649596158, 51255004433520313 };

static const int64_t M1m0m1[79] = { 20043421095776, -54725903086580, 109083418488135, 98854742178695, 136059110849120, 25026866632494, -153311563748296, -171382160092573, 106724888768067, -2428822629670, 3298834657673, 13518846085145, -85836373097273, 85980814298255, 161242287396713, 162811507480231, 144999570408245, -139159664096811, -131965377927819, -167975583744760, 99224516372799, 81373062127878, -5846410063074, 99121236898512, 59906027350994, 24252407282166, -90525792326475, -48066811487182, 302929719313819, 70075686249375, 54383091576429, 149756574099731, -2942845392202, 26931867026774, -116742394021845, 136506783839460, -141552348079474, -6273674192824, 29092313562376, -27878800116858, -20213874385545, 33966860976200, -42153514411672, -48702290934832, -120324462747170, -19256240936569, 110321764644776, 80556024212141, -42803159077481, -12984909517314, 10463270640594, 6811199992092, 35435590419736, -43814246990632, -91566017091914, -90247377999793, -81522796476490, 74454948633909, 45746218546226, 126662030311230, -39771673118721, -82022757299258, 2828187713154, -55346467070710, -25941534457858, -36357005821783, 56256408969259, 45767039546019, -202034528265352, -48307162671855, -62435149777589, -65936758749402, -37070376344463, -48979028206591, 70040398711394, -81327740255685, 113085694657736, 6288234565458, -25262715137229 };

static const int64_t M1m0m2[79] = { 40427748771090, -67933721952399, 84307028823345, 97404581869665, 240648925494340, 38512481873139, -220643529289553, -161112048424281, 85606318154961, 25969819034627, -20926541281188, -13622399984184, -70871180839472, 87628493981263, 183132034183827, 180494755999586, 163045592952981, -148909897267818, -91492437092453, -253324060622459, 79543346237441, 164045514598516, -5656375426308, 110692934141419, 51883068915716, 72714011643567, -112512817938518, -91534079092039, 404069056530703, 96614325343709, 124870299555177, 131873517498804, 74140752688926, 97958056413182, -140080797422789, 162655480511370, -226171389315473, -12576469130917, 50525430274458, -46985111946015, -20043421095776, 54725903086580, -109083418488135, -98854742178695, -136059110849120, -25026866632494, 153311563748296, 171382160092573, -106724888768067, 2428822629670, -3298834657673, -13518846085145, 85836373097273, -85980814298255, -161242287396713, -162811507480231, -144999570408245, 139159664096811, 131965377927819, 167975583744760, -99224516372799, -81373062127878, 5846410063074, -99121236898512, -59906027350994, -24252407282166, 90525792326475, 48066811487182, -302929719313819, -70075686249375, -54383091576429, -149756574099731, 2942845392202, -26931867026774, 116742394021845, -136506783839460, 141552348079474, 6273674192824, -29092313562376 };

static const int64_t M1_m0m1[79] = { -8869503016464993, -3807382736195779, -49250993373477524, -59028545096142219, 25621116424252620, -30427955850102940, -871589022041373, -1447688804401529, -49473598554177078, 19363558605816902, -16928238522571847, -27757647783749262, 48946194611919751, 12428479320518000, -27862154099762492, 42801966557820713, -10149152178349769, -23714149574569521, -51004587872037112, 32884275493816990, 1906030666204710, -14856375722165091, 6600235173626873, 40530221938248310, 38306567319965945, -49523588739777362, 4368730036610174, -47237568328454513, 8661030074291380, 36228932947820299, 19733904620723758, 18729305099484830, -38157909015615665, -2513233066694318, -907632817577114, 42328635886563248, -14447127023793136, 34269839612078568, 31717152721569149, 13156926329931914, -1540428714104169, 47990846936095111, 32307035940426110, 42469380873176497, -19072848299574560, -19894349956518484, 48794803343657861, 3647197153749890, 39338918385070616, 19887134228182711, 4365319763920619, 16661439880269038, -36495830139510310, -12208105220128359, -13476694201078422, -37046065515437177, 4919856974761902, 19155100893386225, 41820867901279204, 8621209027607307, -4196906476408531, 4506805012275268, -5429612806609097, -33904338320170821, -21287472068695656, -2917935615867881, 7932084773264400, 30485465666549027, -57178746080678484, 13266371951994306, -15032204864575176, -56479561699103059, -1382392030281971, -33574879680680921, 48029990791487778, -35248673440768229, 58150923648552903, 9474508933375906, -17554158289422466 };

static const int64_t M1_m0m2[79] = { 3080857428208338, 48133494203665650, -64614071880852220, -12881167708425058, 38145696599149120, -32268894124890968, 46525581388540150, -7294394307499780, -6620242732213296, 32283325581562514, -8730639527841238, -33322879760538076, 934066241092684, 24416210440256718, -45104205635771092, 2034536992946418, -9839713949523804, -38310201786772450, -11584141764630472, -17242418055214614, 8393812952817062, -9013610024550536, 10859225613218194, -4248917397586294, 42574944137391312, -66221722806192174, 56193424491399136, -60970931333098054, -29757695914498904, 45524850133939324, 30064409729150352, -31156064677649754, 2764784060563942, -4907834676566094, 48055206492880316, -1560247156391478, 27813340778750066, -18949017866751812, 35108316578844932, -26745459660291197, 8869503016464993, 3807382736195779, 49250993373477524, 59028545096142219, -25621116424252620, 30427955850102940, 871589022041373, 1447688804401529, 49473598554177078, -19363558605816902, 16928238522571847, 27757647783749262, -48946194611919751, -12428479320518000, 27862154099762492, -42801966557820713, 10149152178349769, 23714149574569521, 51004587872037112, -32884275493816990, -1906030666204710, 14856375722165091, -6600235173626873, -40530221938248310, -38306567319965945, 49523588739777362, -4368730036610174, 47237568328454513, -8661030074291380, -36228932947820299, -19733904620723758, -18729305099484830, 38157909015615665, 2513233066694318, 907632817577114, -42328635886563248, 14447127023793136, -34269839612078568, -31717152721569149 };

static inline void mtoep9(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/10)

static inline void m1toep9(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1SCHOOLBOOK(N/10)


static inline void mtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP55TOP(N/2, mtoep9)

static inline void m1toep10(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP55TOP(N/2, m1toep9)


static inline void toeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP22TOP(N, mtoep10)

static inline void ptoeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	pTOEP22TOP(N, mtoep10)

static inline void m1toep20(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP22TOP(N, m1toep10)


static inline void mtoeplitz_vm0(__int128* restrict rop, const int64_t* restrict vect)
{
	__int128 t0[N/2], t1[N/2], t2[N/2];
	int64_t v0p1[N/2];
	for(int i = 0; i < N/2; i++)
	{
		v0p1[i] = vect[i] + vect[i + N/2];
	}
	mtoep10(t0, v0p1, M[0] + N/2);
	mtoep10(t1, vect, M0m0m1);
	mtoep10(t2, vect + N/2, M0m0m2);
	for(int i = 0; i < N/2; i++)
	{
		rop[i] = t0[i] - t2[i];
		rop[i + N/2] = t0[i] - t1[i];
	}
}


static inline void mtoeplitz_vm1(__int128* restrict rop, const int64_t* restrict vect)
{
	__int128 t0[N/2], t1[N/2], t2[N/2];
	int64_t v0p1[N/2];
	for(int i = 0; i < N/2; i++)
	{
		v0p1[i] = vect[i] + vect[i + N/2];
	}
	mtoep10(t0, v0p1, M[1] + N/2);
	mtoep10(t1, vect, M1m0m1);
	mtoep10(t2, vect + N/2, M1m0m2);
	for(int i = 0; i < N/2; i++)
	{
		rop[i] = t0[i] - t2[i];
		rop[i + N/2] = t0[i] - t1[i];
	}
}


// Utility function to extract the lower 64 bits of each vector coefficient
static inline void m1toeplitz_vm(int64_t* restrict rop, const __int128* restrict vect)
{
	int64_t t0[N/2], t1[N/2], t2[N/2];
	int64_t v0p1[N/2], v[N];
	for(int i = 0; i < N/2; i++)
	{
		v[i] = vect[i];
		v[i + N/2] = vect[i + N/2];
		v0p1[i] = v[i] + v[i + N/2];
	}
	m1toep10(t0, v0p1, M1 + N/2);
	m1toep10(t1, v, M1_m0m1);
	m1toep10(t2, v + N/2, M1_m0m2);
	for(int i = 0; i < N/2; i++)
	{
		rop[i] = t0[i] - t2[i];
		rop[i + N/2] = t0[i] - t1[i];
	}
}

void (* const multbym[2]) (__int128* restrict rop, const int64_t* restrict vect) = { mtoeplitz_vm0, mtoeplitz_vm1 };

