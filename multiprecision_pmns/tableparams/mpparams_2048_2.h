#define N 18
#define NBCHUNKS 2
#define LAMBDA 2
#define RHOver2 60

static const uint64_t RHOhi = 59086042207538569u;

static const int64_t M[2][35] = { {
		316537275148411294, 623520688096490280, 641025306475230314, 600710578985976392, 736336014895229968, 721023860537565644, 614881183128804400, 1131764362722959376, 536555701865612572, 771482429838119322, 661599439874919724, 925151408813014596, 116500921862614408, 8594021239294988, 953914224914701034, 123489950587334624, 547187003122331760, 463249909651618011, 158268637574205647, 311760344048245140, 320512653237615157, 300355289492988196, 368168007447614984, 936972682572206310, 307440591564402200, 1142342933664903176, 268277850932806286, 385741214919059661, 907260472240883350, 462575704406507298, 58250460931307204, 580757762923070982, 1053417864760774005, 638205727597090800, 850054253864589368
	}, {
-5091030945661372, 3770690192481136, 5851026624314882, -11347226554616958, -15360291304565140, -1409601535953845, -15497951748796142, 3334328753543497, -2905050132538186, 6403229925204700, -20641779739586109, -5952734765924718, -8296807957966990, -434587185593511, 4332115763468391, -212406763506357, 6962807261973485, -368417259381721, -2545515472830686, 1885345096240568, 2925513312157441, -5673613277308479, -7680145652282570, -704800767976923, -7748975874398071, 1667164376771748, -1452525066269093, 3201614962602350, -10320889869793055, -2976367382962359, -4148403978983495, -217293592796756, 2166057881734195, -106203381753179, 3481403630986742
} };

static const int64_t M1[] = {
981674947085205586, 986375564018613054, 454169351633589056, 575106697255447298, 798898560441417088, 1004848663369815176, 812805864752134346, 1013964000096699154, 158708331475301658, 813001415332514322, 543150140558708282, 52508579134008702, 105945097855303616, 156866002006034140, 761968921876445776, 242877256464838194, 313228850912954362, 42743309838114957, 1067298225846026281, 493187782009306527, 803545428120218016, 864014100931147137, 975910032524132032, 1078885083988331076, 982863684679490661, 506982000048349577, 79354165737650829, 406500707666257161, 271575070279354141, 602715041870427839, 629433301231075296, 78433001003017070, 957445213241646376, 121438628232419097, 156614425456477181
};

static inline void mtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/3)

static inline void m1toep10(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1SCHOOLBOOK(N/3)


static inline void toeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP33TOP(N, mtoep10)

static inline void ptoeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	pTOEP33TOP(N, mtoep10)

static inline void m1toep20(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP33TOP(N, m1toep10)


static inline void mtoeplitz_vm0(__int128* restrict rop, const int64_t* restrict vect)
{
	toeplitz_vm(rop, vect, M[0]);
}



static inline void mtoeplitz_vm1(__int128* restrict rop, const int64_t* restrict vect)
{
	toeplitz_vm(rop, vect, M[1]);
}



static inline void m1toeplitz_vm(int64_t* restrict rop, const __int128* restrict vect)
{
	int64_t v[N];
	for(int i = 0; i < N; i++)
		v[i] = vect[i];
	m1toep20(rop, v, M1);
}


void (* const multbym[2]) (__int128* restrict rop, const int64_t* restrict vect) = { mtoeplitz_vm0, mtoeplitz_vm1 };

