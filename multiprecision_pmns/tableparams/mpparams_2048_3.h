#define N 12
#define NBCHUNKS 3
#define LAMBDA 2
#define RHOver2 59

static const uint64_t RHOhi = 18569713855389884u;

static const int64_t M[3][23] = { {
		322440158243253210, 337720139181692274, 298011966937326038, 322734106838121676, 250668474486983864, 502712658438584764, 134477231881354926, 356042532185163918, 70810479596436738, 6041970597333466, 330354512093440470, 521967431995860275, 449450455273338349, 168860069590846137, 149005983468663019, 449597429570772582, 125334237243491932, 539586705371004126, 67238615940677463, 178021266092581959, 323635615949930113, 291251361450378477, 453407632198431979
	}, {
		470540090032145121, 83313857729021678, 256352255050104970, 111916515066802733, 273056639264268174, 352797902044847071, 103752499341776704, 567326601301966600, 299904318597155285, 375844913642374893, 98213466432510899, 261042164580822121, 235270045016072560, 329887305016222583, 416406503676764229, 55958257533401366, 424758695783845831, 464629327174135279, 340106625822600096, 283663300650983300, 438182535450289386, 187922456821187446, 49106733216255449
	}, {
1220148983770204, -3522330676524233, -923042718053059, 3250162014415126, -1089869103190653, 7054890191324359, -4844800813475939, 1037904286943166, 1828387281657289, 8259679267399994, -2746336918076216, -1361875455949529, 610074491885102, -1761165338262117, -461521359026530, 1625081007207563, -544934551595327, 3527445095662179, -2422400406737970, 518952143471583, 914193640828644, 4129839633699997, -1373168459038108
} };

static const int64_t M1[] = {
278620158306938882, 340775567351374104, 187273569404847972, 337538714336286250, 461291393121697626, 16839595389190580, 101951783890450266, 454109479363689752, 170168956813625450, 201000836930453788, 504175834913577576, 295189417109825669, 427540455305181185, 170387783675687052, 93636784702423986, 456999733319854869, 518876072712560557, 8419797694595290, 50975891945225133, 227054739681844876, 85084478406812725, 388730794616938638, 540318293608500532
};

static inline void mtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/3)

static inline void m1toep10(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1SCHOOLBOOK(N/3)


static inline void toeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP33TOP(N, mtoep10)

static inline void ptoeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	pTOEP33TOP(N, mtoep10)

static inline void m1toep20(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP33TOP(N, m1toep10)


static inline void mtoeplitz_vm0(__int128* restrict rop, const int64_t* restrict vect)
{
	toeplitz_vm(rop, vect, M[0]);
}



static inline void mtoeplitz_vm1(__int128* restrict rop, const int64_t* restrict vect)
{
	toeplitz_vm(rop, vect, M[1]);
}



static inline void mtoeplitz_vm2(__int128* restrict rop, const int64_t* restrict vect)
{
	toeplitz_vm(rop, vect, M[2]);
}



static inline void m1toeplitz_vm(int64_t* restrict rop, const __int128* restrict vect)
{
	int64_t v[N];
	for(int i = 0; i < N; i++)
		v[i] = vect[i];
	m1toep20(rop, v, M1);
}


void (* const multbym[3]) (__int128* restrict rop, const int64_t* restrict vect) = { mtoeplitz_vm0, mtoeplitz_vm1, mtoeplitz_vm2 };

