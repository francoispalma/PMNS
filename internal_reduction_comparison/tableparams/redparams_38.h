#define N 38
#define LAMBDA 2
#define RHO 278105439251866670
#define RHOhi 278105439251866670
#define DIVBYRHO 52
#define LENGTH_OF_P 32

static const uint64_t __P__[32] = { 5514905641449827479u, 11706186483952310733u, 3098943126415801660u, 14834115591182443179u, 12695810000403418u, 10425442978601449559u, 6777735055323380557u, 5864028878361536587u, 17984381903043069566u, 1790531425397564734u, 17271823313415187420u, 2217535758520538209u, 7260475229728761361u, 2998605809914630581u, 2011677270945189290u, 16474822539441691707u, 2613995071467720331u, 11435231986745977128u, 9760553276632547391u, 13306389431818440012u, 4856386512049954938u, 16845836318220708647u, 12237716614857300342u, 5090415533046572264u, 4420847752250430052u, 3160051762688095050u, 6658244600419082244u, 18413830805415497058u, 2722093880082813340u, 8393091865399906612u, 14038945372259393918u, 17556362378825649265u };

static const uint64_t __invP__[32] = { 15801184109983437607u, 4089125593711130156u, 13771938990709456184u, 9517897142474243613u, 18072800230930011806u, 6304080818039429352u, 11102547427323398406u, 11291983251625508089u, 7966531270601218542u, 4614200073295445631u, 6695739472559510570u, 7281928360420022807u, 16088920050733023787u, 16943023335261876963u, 1486237779843231188u, 528405419300822638u, 18277528824314436054u, 15426223223661822410u, 7706657637855912749u, 6454129766749912977u, 17163496301901190634u, 4467624923477175023u, 13450148265618740893u, 3354592519291145650u, 5998468060548241769u, 4173617351321884796u, 3997176832286558644u, 1073529024805492204u, 4060837486281921291u, 12605958101368748459u, 12127133370054969292u, 4185572761499255854u };

static const int64_t M[75] = { 4943162561774204, 18793506793723954, 5500155382915328, -11948695389514142, 926170180838996, -10810224935780590, 24749933971293836, 1866260940207196, 2260513126888342, 10639958025977396, -7948491880321394, 8165817864164034, -10157534276310954, -1506463000623342, 4158641623411602, 5687986032051212, -6802634069196524, -3511432139927176, -697964392229322, 2721000507899820, 1783540029348518, 14845087488556234, -23275300333424792, -3869584094423322, -3503597657752474, -4561805236172330, 3278169284352888, -3093310893194244, 17201260911790428, 9900022462679202, 433840649411342, 1245557276616768, 8371585302541062, 8251547327527762, -18289221746285162, 4508225945535068, 3662055226918832, -4235180290286879, 2471581280887102, 9396753396861977, 2750077691457664, -5974347694757071, 463085090419498, -5405112467890295, 12374966985646918, 933130470103598, 1130256563444171, 5319979012988698, -3974245940160697, 4082908932082017, -5078767138155477, -753231500311671, 2079320811705801, 2843993016025606, -3401317034598262, -1755716069963588, -348982196114661, 1360500253949910, 891770014674259, 7422543744278117, -11637650166712396, -1934792047211661, -1751798828876237, -2280902618086165, 1639084642176444, -1546655446597122, 8600630455895214, 4950011231339601, 216920324705671, 622778638308384, 4185792651270531, 4125773663763881, -9144610873142581, 2254112972767534, 1831027613459416 };

static const int64_t Mhi[75] = { 0, 0, 0, -1, 0, -1, 0, 0, 0, 0, -1, 0, -1, -1, 0, 0, -1, -1, -1, 0, 0, 0, -1, -1, -1, -1, 0, -1, 0, 0, 0, 0, 0, 0, -1, 0, 0, -1, 0, 0, 0, -1, 0, -1, 0, 0, 0, 0, -1, 0, -1, -1, 0, 0, -1, -1, -1, 0, 0, 0, -1, -1, -1, -1, 0, -1, 0, 0, 0, 0, 0, 0, -1, 0, 0 };

static const uint64_t Mlo[75] = { 4943162561774204u, 18793506793723954u, 5500155382915328u, 18434795378320037474u, 926170180838996u, 18435933848773771026u, 24749933971293836u, 1866260940207196u, 2260513126888342u, 10639958025977396u, 18438795581829230222u, 8165817864164034u, 18436586539433240662u, 18445237610708928274u, 4158641623411602u, 5687986032051212u, 18439941439640355092u, 18443232641569624440u, 18446046109317322294u, 2721000507899820u, 1783540029348518u, 14845087488556234u, 18423468773376126824u, 18442874489615128294u, 18443240476051799142u, 18442182268473379286u, 3278169284352888u, 18443650762816357372u, 17201260911790428u, 9900022462679202u, 433840649411342u, 1245557276616768u, 8371585302541062u, 8251547327527762u, 18428454851963266454u, 4508225945535068u, 3662055226918832u, 18442508893419264737u, 2471581280887102u, 9396753396861977u, 2750077691457664u, 18440769726014794545u, 463085090419498u, 18441338961241661321u, 12374966985646918u, 933130470103598u, 1130256563444171u, 5319979012988698u, 18442769827769390919u, 4082908932082017u, 18441665306571396139u, 18445990842209239945u, 2079320811705801u, 2843993016025606u, 18443342756674953354u, 18444988357639588028u, 18446395091513436955u, 1360500253949910u, 891770014674259u, 7422543744278117u, 18435106423542839220u, 18444809281662339955u, 18444992274880675379u, 18444463171091465451u, 1639084642176444u, 18445197418262954494u, 8600630455895214u, 4950011231339601u, 216920324705671u, 622778638308384u, 4185792651270531u, 4125773663763881u, 18437599462836409035u, 2254112972767534u, 1831027613459416u };

static const int64_t M1[75] = { 7794017691736500928, 2300449964936476434, -4021197001849962936, 1775512737255796844, 6814607546187497372, -1869419109357854368, -4514681688644016476, -1743755611566004690, 4126983441724530894, 4588856151785769210, 6627157863716439514, -4207623502488435246, 1731645888664566200, 2389880120341458738, 3051575208014295196, -4685237019762109648, -3332041486377098958, -466373604652520818, -591718454335438988, 6903840481133043086, -8885476863662301318, 8293077961415700906, 5149154512731939466, -7837045253240570210, 8571209095492525970, -2615817740219790250, 471376758407376488, 5479728992328607614, -3419793572172798008, -5714070773164227644, 7280278856354960602, -514883540196632330, 8962030309875701310, 8274325271953545404, -1557944932404966848, -7672165223949282360, -2780065076952693412, -1718790091355863915, 3897008845868250464, -8073147054386537591, 7212773535929794340, -8335615668226877386, -5816068263761027122, -934709554678927184, 6966031192532767570, -871877805783002345, -7159880315992510361, 2294428075892884605, -5909793104996556051, -2103811751244217623, 865822944332283100, -8028431976684046439, -7697584432847628210, -2342618509881054824, 7557351293666226329, 8990185234528515399, 8927512809687056314, 3451920240566521543, -4442738431831150659, -5076833056146925355, 2574577256365969733, 5304849410234490703, -4937767489108512823, -1307908870109895125, 235688379203688244, 2739864496164303807, -1709896786086399004, 6366336650272661986, 3640139428177480301, -257441770098316165, 4481015154937850655, 4137162635976772702, 8444399570652292384, -3836082611974641180, 7833339498378429102 };

static const int64_t M2hi[75] = { -3460412330966046946, -1147978485304873019, -1623140342515608686, -3302433529476506215, -3530555652970565753, -6797451426061217157, 6088141907887199830, -2720580787274173337, -5365515235085578785, 2449249749817006272, 4627684046897752917, 8872680806192062389, -1563718168505986488, -7323093156800830683, -7955007749973829231, 8135519211490142565, 7588429357002252094, 4237825425220974624, -3950030744409679346, -4616551580960088272, -7411210411717373569, -1674973015688032717, -4572142940594852866, -134753074266059944, 4170566282424740953, 8760435783764503369, 480409148229755514, 1675772055468870984, -483838024575276575, -1064300833098374622, -1632765230192495852, -6395082681738384005, -9187971463662933124, -4485815959913010312, -7518867606131359256, -895104332077406155, 378084327626602132, 3989733122067839072, -1730206165483023473, -573989242652436510, 8411801865596971465, -1651216764738253108, 7458094210369492931, 5824646323824167229, 3044070953943599915, 7863081643217689139, -2682757617542789393, 1224624874908503136, -6909530013405899350, 4436340403096031194, 8441512952601782564, 5561825458454360466, -3977503874986914616, 4067759605745071282, 3794214678501126047, 2118912712610487312, 7248356664649936135, -2308275790480044136, 5517766830996089023, -837486507844016359, 6937300566557349375, -67376537133029972, 2085283141212370476, -4843154144972524124, 240204574114877757, -8385486009120340316, 8981453024567137520, -532150416549187311, -816382615096247926, 6025830695985583805, -4593985731831466562, -2242907979956505156, -3759433803065679628, -447552166038703078, 189042163813301066 };

static const uint64_t M2lo[75] = { 7794017691736500928u, 2300449964936476434u, 14425547071859588680u, 1775512737255796844u, 6814607546187497372u, 16577324964351697248u, 13932062385065535140u, 16702988462143546926u, 4126983441724530894u, 4588856151785769210u, 6627157863716439514u, 14239120571221116370u, 1731645888664566200u, 2389880120341458738u, 3051575208014295196u, 13761507053947441968u, 15114702587332452658u, 17980370469057030798u, 17855025619374112628u, 6903840481133043086u, 9561267210047250298u, 8293077961415700906u, 5149154512731939466u, 10609698820468981406u, 8571209095492525970u, 15830926333489761366u, 471376758407376488u, 5479728992328607614u, 15026950501536753608u, 12732673300545323972u, 7280278856354960602u, 17931860533512919286u, 8962030309875701310u, 8274325271953545404u, 16888799141304584768u, 10774578849760269256u, 15666678996756858204u, 16727953982353687701u, 3897008845868250464u, 10373597019323014025u, 7212773535929794340u, 10111128405482674230u, 12630675809948524494u, 17512034519030624432u, 6966031192532767570u, 17574866267926549271u, 11286863757717041255u, 2294428075892884605u, 12536950968712995565u, 16342932322465333993u, 865822944332283100u, 10418312097025505177u, 10749159640861923406u, 16104125563828496792u, 7557351293666226329u, 8990185234528515399u, 8927512809687056314u, 3451920240566521543u, 14004005641878400957u, 13369911017562626261u, 2574577256365969733u, 5304849410234490703u, 13508976584601038793u, 17138835203599656491u, 235688379203688244u, 2739864496164303807u, 16736847287623152612u, 6366336650272661986u, 3640139428177480301u, 18189302303611235451u, 4481015154937850655u, 4137162635976772702u, 8444399570652292384u, 14610661461734910436u, 7833339498378429102u };

static const int64_t Gprime[75] = { 2098918766312302339, -2461064141342624247, -3298016742736962735, 2701852189693260978, 2800237531569517067, 2349620300415664724, -237892230777593501, 186673792690202574, 2035322126380435247, 1670122878766203560, 1714825424404761934, -411441414206355556, -3316851387845128610, -1022042040765313990, -1259326855225970150, 2126227324229141405, 893548410301022213, -1166484744109599181, -3533418084311838713, 142891257397395407, 178215528391652385, 2233761546589737333, 138786299522279196, -1997543445639374991, -1723351175927165011, 1848755824590623313, 1086337682154005276, 592197156650735099, -891189928897431258, -655568961350007318, 2086928421856403302, 980596592443473754, 1415169776568391135, -1235461220477387806, -1777127030808677470, 1040868730185052117, 1407816644909533927, 610081580118062841, 1049459383156151170, -1230532070671312123, -1649008371368481367, 1350926094846630489, 1400118765784758534, 1174810150207832362, -118946115388796751, 93336896345101287, 1017661063190217623, 835061439383101780, 857412712202380967, -205720707103177778, -1658425693922564305, -511021020382656995, -629663427612985075, 1063113662114570703, 446774205150511106, -583242372054799591, -1766709042155919356, 71445628698697704, 89107764195826192, 1116880773294868666, 69393149761139598, -998771722819687495, -861675587963582505, 924377912295311657, 543168841077002638, 296098578325367550, -445594964448715629, -327784480675003659, 1043464210928201651, 490298296221736877, 707584888284195567, -617730610238693903, -888563515404338735, 520434365092526058, 703908322454766963 };

static inline void mtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/2)

static inline void mmmtoep10(__int128* restrict rop, const __int128* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/2)

static inline void mmtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/2)

static inline void m1toep10(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1SCHOOLBOOK(N/2)


static inline void toeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP22TOP(N, mtoep10)

static inline void mtoeptop(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	MTOEP22TOP(N, mmtoep10, mmmtoep10)

static inline void m1toep20(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP22TOP(N, m1toep10)


static inline void mtoeplitz_vm(__int128* restrict rop, const int64_t* restrict vect)
{
	mtoeptop(rop, vect, M);
}


static inline void m1toeplitz_vm(int64_t* restrict rop, const __int128* restrict vect)
{
	int64_t v[N];
	for(int i = 0; i < N; i++)
		v[i] = vect[i];
	m1toep20(rop, v, M1);
}


static inline void mtoep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/2)


void toep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	TOEP22TOP128(N, mtoep128)


static inline void bigtoep128(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/2)


void bigmattoep(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	bigmatTOEP22TOP(N, bigtoep128)

