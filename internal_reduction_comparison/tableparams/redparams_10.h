#define N 10
#define LAMBDA 2
#define RHO 12554346994634038
#define RHOhi 12554346994634038
#define DIVBYRHO 47
#define LENGTH_OF_P 8

static const uint64_t __P__[8] = { 5681743005604537271u, 16265202597772863288u, 7551860841344613874u, 5215243048155041586u, 14460572092152363789u, 2294726292418917534u, 5847184843594988740u, 14820997415473647390u };

static const uint64_t __invP__[8] = { 10723702084003883527u, 5657249082863638139u, 14459744369136605487u, 14605269893164530855u, 17234765014735504283u, 9033365736345041097u, 5972246635516019546u, 11547466473181096549u };

static const int64_t M[19] = { 1981137491139654, 2904766713555704, -382395497521740, 166345180956992, -3478736737243412, -382929071873762, 540373380275052, 95148257675884, 2344252042906090, -278262621485749, 990568745569827, 1452383356777852, -191197748760870, 83172590478496, -1739368368621706, -191464535936881, 270186690137526, 47574128837942, 1172126021453045 };

static const int64_t Mhi[19] = { 0, 0, -1, 0, -1, -1, 0, 0, 0, -1, 0, 0, -1, 0, -1, -1, 0, 0, 0 };

static const uint64_t Mlo[19] = { 1981137491139654u, 2904766713555704u, 18446361678212029876u, 166345180956992u, 18443265336972308204u, 18446361144637677854u, 540373380275052u, 95148257675884u, 2344252042906090u, 18446465811088065867u, 990568745569827u, 1452383356777852u, 18446552875960790746u, 83172590478496u, 18445004705340929910u, 18446552609173614735u, 270186690137526u, 47574128837942u, 1172126021453045u };

static const int64_t M1[19] = { 4797837514999208398, -7857315171625780682, 7762280137847750510, 7043263896161703242, 3817431720924936694, 3371563315723463212, -4422252780618147142, 2446852076374311432, 1862363313135060664, -7532851168620562191, 2398918757499604199, 5294714451041885467, 3881140068923875255, -5701740088773924187, -7314656176392307461, 1685781657861731606, -2211126390309073571, -7999945998667620092, -8292190380287245476 };

static const int64_t M2hi[19] = { 5148910681123714892, -7251809035858373776, -2767251649741971152, 5536675480028786093, 6613266202824810537, 9117898186880561954, -7446753195293374485, 7442481542923832743, 4795915911593654107, 7103687386407018769, 2574455340561857446, -3625904517929186888, -1383625824870985576, -6455034296840382762, 3306633101412405268, 4558949093440280977, 5499995439208088565, 3721240771461916371, 2397957955796827053 };

static const uint64_t M2lo[19] = { 4797837514999208398u, 10589428902083770934u, 7762280137847750510u, 7043263896161703242u, 3817431720924936694u, 3371563315723463212u, 14024491293091404474u, 2446852076374311432u, 1862363313135060664u, 10913892905088989425u, 2398918757499604199u, 5294714451041885467u, 3881140068923875255u, 12745003984935627429u, 11132087897317244155u, 1685781657861731606u, 16235617683400478045u, 10446798075041931524u, 10154553693422306140u };

static const int64_t Gprime[19] = { -807053629981250636, 2944592258478999253, -3005296293918200750, 3828461229295461226, -2926903275028113640, 1442530519013863833, -1255050743679416716, 3318417213382761096, -2305135442378856833, 1595395883674601963, -403526814990625318, 1472296129239499627, -1502648146959100375, 1914230614647730613, -1463451637514056820, 721265259506931917, -627525371839708358, 1659208606691380548, -1152567721189428416 };

static inline void mtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/2)

static inline void mmmtoep10(__int128* restrict rop, const __int128* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/2)

static inline void mmtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/2)

static inline void m1toep10(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1SCHOOLBOOK(N/2)


static inline void toeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP22TOP(N, mtoep10)

static inline void mtoeptop(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	MTOEP22TOP(N, mmtoep10, mmmtoep10)

static inline void m1toep20(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP22TOP(N, m1toep10)


static inline void mtoeplitz_vm(__int128* restrict rop, const int64_t* restrict vect)
{
	mtoeptop(rop, vect, M);
}


static inline void m1toeplitz_vm(int64_t* restrict rop, const __int128* restrict vect)
{
	int64_t v[N];
	for(int i = 0; i < N; i++)
		v[i] = vect[i];
	m1toep20(rop, v, M1);
}


static inline void mtoep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/2)


void toep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	TOEP22TOP128(N, mtoep128)


static inline void bigtoep128(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/2)


void bigmattoep(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	bigmatTOEP22TOP(N, bigtoep128)

