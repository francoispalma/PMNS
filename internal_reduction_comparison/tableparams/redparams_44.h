#define N 44
#define LAMBDA 2
#define RHO 1997466294500438
#define RHOhi 1997466294500438
#define DIVBYRHO 44
#define LENGTH_OF_P 32

static const uint64_t __P__[32] = { 18431397062126761887u, 15670873569104290734u, 13803794991096024319u, 3277174268922694344u, 18371609575636138287u, 2108850277776001021u, 8005931945858750861u, 12252966022037655344u, 8017781086810632574u, 9453825384795094267u, 13103311008501652723u, 12598605479385029384u, 7202669942013916182u, 9880921852770987267u, 410789284560127177u, 17758733931021959432u, 13303416170790637345u, 11569841645902194186u, 2500942192245638526u, 533650649343294793u, 14309046783524167207u, 9727931026613547207u, 8179374517663449557u, 2111145122972900605u, 1351934173366361387u, 762991948954342562u, 8092716692311102372u, 13811990629213432478u, 13163549850996773038u, 13995667204244541629u, 9621049612515658250u, 15417988641266195462u };

static const uint64_t __invP__[32] = { 9266317484820587615u, 16218756584955753406u, 9009665030992158097u, 3334069094546412109u, 8083538449231598684u, 10711402204304826065u, 12620784037407414504u, 14572766636861139277u, 18288800381443254599u, 4250998915766382971u, 9581314543035125318u, 8584529690907511665u, 12448492692634786778u, 2576930863078870389u, 8576653133020883924u, 5680189232582811900u, 5220874948557187099u, 9918920542744404446u, 3685287367926309785u, 12943661265961900987u, 8991286121602974813u, 13514839846586192171u, 3750946178823147623u, 10233375675861528606u, 17881345718637468917u, 16041681369812694192u, 10374027628308769850u, 7254194586508839188u, 4402455567012816060u, 16832357394936278918u, 6727505382173492585u, 10407357195077663936u };

static const int64_t M[87] = { 51866787631600, 26698566556870, 62881202626340, -33340707087106, -160081693289116, 19729839793044, -34115641664666, 11496618436946, 76600112393612, 6768890689442, -41300446836614, -133264651722586, 13059993017796, -63153770795656, 70420582643960, -36772375357130, -21629700431556, 44580683863860, -87732885138260, -4971809546312, 28326939306620, 62218980149484, -2425707093130, -19755670458768, -44677787403988, 141545519167086, -21362873199160, -34732562166142, 37876821797794, 21430352173226, 33565820448430, 70220273724166, 11983821909842, -115521012084292, 42700949970302, 1638092042542, 39001540266622, -35509810779002, -21177721503094, -54994900696522, -32878166933938, 25761517689820, 23486644108568, 74205849905429, 25933393815800, 13349283278435, 31440601313170, -16670353543553, -80040846644558, 9864919896522, -17057820832333, 5748309218473, 38300056196806, 3384445344721, -20650223418307, -66632325861293, 6529996508898, -31576885397828, 35210291321980, -18386187678565, -10814850215778, 22290341931930, -43866442569130, -2485904773156, 14163469653310, 31109490074742, -1212853546565, -9877835229384, -22338893701994, 70772759583543, -10681436599580, -17366281083071, 18938410898897, 10715176086613, 16782910224215, 35110136862083, 5991910954921, -57760506042146, 21350474985151, 819046021271, 19500770133311, -17754905389501, -10588860751547, -27497450348261, -16439083466969, 12880758844910, 11743322054284 };

static const int64_t Mhi[87] = { 0, 0, 0, -1, -1, 0, -1, 0, 0, 0, -1, -1, 0, -1, 0, -1, -1, 0, -1, -1, 0, 0, -1, -1, -1, 0, -1, -1, 0, 0, 0, 0, 0, -1, 0, 0, 0, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, -1, -1, 0, -1, 0, 0, 0, -1, -1, 0, -1, 0, -1, -1, 0, -1, -1, 0, 0, -1, -1, -1, 0, -1, -1, 0, 0, 0, 0, 0, -1, 0, 0, 0, -1, -1, -1, -1, 0, 0 };

static const uint64_t Mlo[87] = { 51866787631600u, 26698566556870u, 62881202626340u, 18446710733002464510u, 18446583992016262500u, 19729839793044u, 18446709958067886950u, 11496618436946u, 76600112393612u, 6768890689442u, 18446702773262715002u, 18446610809057829030u, 13059993017796u, 18446680919938755960u, 70420582643960u, 18446707301334194486u, 18446722444009120060u, 44580683863860u, 18446656340824413356u, 18446739101900005304u, 28326939306620u, 62218980149484u, 18446741648002458486u, 18446724318039092848u, 18446699395922147628u, 141545519167086u, 18446722710836352456u, 18446709341147385474u, 37876821797794u, 21430352173226u, 33565820448430u, 70220273724166u, 11983821909842u, 18446628552697467324u, 42700949970302u, 1638092042542u, 39001540266622u, 18446708563898772614u, 18446722895988048522u, 18446689078808855094u, 18446711195542617678u, 25761517689820u, 23486644108568u, 74205849905429u, 25933393815800u, 13349283278435u, 31440601313170u, 18446727403356008063u, 18446664032862907058u, 9864919896522u, 18446727015888719283u, 5748309218473u, 38300056196806u, 3384445344721u, 18446723423486133309u, 18446677441383690323u, 6529996508898u, 18446712496824153788u, 35210291321980u, 18446725687521873051u, 18446733258859335838u, 22290341931930u, 18446700207266982486u, 18446741587804778460u, 14163469653310u, 31109490074742u, 18446742860856005051u, 18446734195874322232u, 18446721734815849622u, 70772759583543u, 18446733392272952036u, 18446726707428468545u, 18938410898897u, 10715176086613u, 16782910224215u, 35110136862083u, 5991910954921u, 18446686313203509470u, 21350474985151u, 819046021271u, 19500770133311u, 18446726318804162115u, 18446733484848800069u, 18446716576259203355u, 18446727634626084647u, 12880758844910u, 11743322054284u };

static const int64_t M1[87] = { 4884547792308451360, -5866250307098079950, -854786226392582208, -6605683790751306172, 4906288384802853464, -9099447735434151290, 3072180934936621162, -1106736435102744216, 4512425208552969732, -7148959517816944862, 7319566084923520680, 590058207249825362, 6703468694881302568, -2495854573758772710, -427478330726769782, -1511606849129241792, -7554801086520712424, -1842672701435485054, -5686132644517924654, 5328329034042172554, -8007174287278112246, -5937032380841217542, 8190957705821535244, 5480951520610625776, 108578065977237590, -7472978359335656090, -2560930811013804220, -7124269428643270314, -5318825501128139038, 6977316375847798972, 4837483115964434286, -27990258161454064, 8344472944319436980, 4961626512636687366, -7952877516690639658, -98258741294195272, -7031126728070149088, -2500193096529949852, 2591558910396891090, 6600372375537084908, 413576826890533296, -8527544939026140026, -9129124098898002634, -1405425305810160873, -6781098140700550128, -2933125153549039975, -427393113196291104, -3302841895375653086, 2453144192401426732, 4673648169137700163, -7687281569386465227, -553368217551372108, 2256212604276484866, -3574479758908472431, -5563588994393015468, 295029103624912681, 3351734347440651284, 7975444749975389453, -213739165363384891, -755803424564620896, -3777400543260356212, 8302035686137033281, 6380305714595813481, -6559207519833689531, 5219784893215719685, 6254855846434167037, -5127893183944008186, -6482896276549462920, 54289032988618795, 5486882857186947763, -1280465405506902110, -3562134714321635157, -2659412750564069519, 3488658187923899486, -6804630478872558665, 9209376907774048776, -5051135564695057318, -6742558780536432125, -3976438758345319829, 9174242666207678172, -3515563364035074544, 7973275488589800882, -7927592581656330263, -5923185849086233354, 206788413445266648, 4959599567341705795, 4658809987405774491 };

static const int64_t M2hi[87] = { 2411169368777623283, 6460651037906869149, 3487315229540317269, 8356256624979824291, 2506824567823203792, 2037123584058345330, -5342467865752925997, -6590888302440993743, -5624491197827951862, 6658917010568393177, -3750784537082819815, 3872914438559846952, -6543044548206197832, -3979919362050380428, 6405165212411360471, 322109241842597929, -7972287741535986313, 9077162226829772746, -3085734065232680098, 7069110443210400453, -6524867491363025460, 2803765816913713100, 3417779611974691687, 4766544140179987711, -2561445502402975370, -8462324972919336118, 2044357974762990647, -581438496414654863, -6513838976219302965, -6729011255769816766, 3777753517128490785, 6119111264035003828, 6715919330450628665, 5749892880984111533, 4790296301990001169, 3043335969806208300, 5021378081880499879, -7003616939160086982, 3976696894693662821, -6839388873706856181, 6075596572723882158, -2538045961608372826, -693337291537415624, 962580784721491012, 1205584684388811641, -5993046517901341234, -7479714422084617174, -5045243724364863663, -7969959752943173912, -8204810244825603143, 6552138103978312809, 5927927885634278936, -2812245598913975931, 3329458505284196588, -1875392268541409908, -7286914817574852332, 5951849762751676892, 7233412355829585594, 3202582606205680235, -9062317415933476844, -3986143870767993157, -4684790923439889435, -1542867032616340049, 3534555221605200226, -3262433745681512730, 1401882908456856550, -7514482230867429965, -6840099966764781953, -1280722751201487685, 4992209550395107749, 1022178987381495323, 8932652788647448376, 5966452548745124325, 5858866408969867425, -7334495278290530416, 3059555632017501914, -5865412371629461476, -6348425596362720042, 2395148150995000584, 1521667984903104150, 2510689040940249939, -3501808469580043491, 1988348447346831410, -3419694436853428091, -6185573750492834729, -1269022980804186413, 8876703391086067996 };

static const uint64_t M2lo[87] = { 4884547792308451360u, 12580493766611471666u, 17591957847316969408u, 11841060282958245444u, 4906288384802853464u, 9347296338275400326u, 3072180934936621162u, 17340007638606807400u, 4512425208552969732u, 11297784555892606754u, 7319566084923520680u, 590058207249825362u, 6703468694881302568u, 15950889499950778906u, 18019265742982781834u, 16935137224580309824u, 10891942987188839192u, 16604071372274066562u, 12760611429191626962u, 5328329034042172554u, 10439569786431439370u, 12509711692868334074u, 8190957705821535244u, 5480951520610625776u, 108578065977237590u, 10973765714373895526u, 15885813262695747396u, 11322474645066281302u, 13127918572581412578u, 6977316375847798972u, 4837483115964434286u, 18418753815548097552u, 8344472944319436980u, 4961626512636687366u, 10493866557018911958u, 18348485332415356344u, 11415617345639402528u, 15946550977179601764u, 2591558910396891090u, 6600372375537084908u, 413576826890533296u, 9919199134683411590u, 9317619974811548982u, 17041318767899390743u, 11665645933009001488u, 15513618920160511641u, 18019350960513260512u, 15143902178333898530u, 2453144192401426732u, 4673648169137700163u, 10759462504323086389u, 17893375856158179508u, 2256212604276484866u, 14872264314801079185u, 12883155079316536148u, 295029103624912681u, 3351734347440651284u, 7975444749975389453u, 18233004908346166725u, 17690940649144930720u, 14669343530449195404u, 8302035686137033281u, 6380305714595813481u, 11887536553875862085u, 5219784893215719685u, 6254855846434167037u, 13318850889765543430u, 11963847797160088696u, 54289032988618795u, 5486882857186947763u, 17166278668202649506u, 14884609359387916459u, 15787331323145482097u, 3488658187923899486u, 11642113594836992951u, 9209376907774048776u, 13395608509014494298u, 11704185293173119491u, 14470305315364231787u, 9174242666207678172u, 14931180709674477072u, 7973275488589800882u, 10519151492053221353u, 12523558224623318262u, 206788413445266648u, 4959599567341705795u, 4658809987405774491u };

static const int64_t Gprime[87] = { 3651218460458362028, -1000830780085888652, 1545865171650226241, -716124613009985946, 1718613111144823516, 21839307353948022, 777808269186824651, 90103814910573782, 1011617853704976400, -51683609109500732, 2099861736732084976, 814381432982708958, 2859233524497068350, -1086786964326286991, 2617445040145174852, -1238148518493051835, 2101693902794400962, 2202026441291106477, 647940357611489088, -274465163567280700, 133785738020235951, 1372630311183032670, 507064384107814022, 731839233527567455, 546382402206157806, 605607136054742005, 561431894373618752, -1017460359900792227, 1642000897665353001, -785051653864034300, 2077434363405657719, -1086144566363073503, 227153462832341652, 114639987209134561, 442134807180799527, 555599256183743753, 311244950886187556, 493286240239044190, -117679910600442978, -897478893207886723, 1553942997467438108, -350428679015522868, 2504749376769597279, -460837282989738147, 1825609230229181014, -500415390042944326, 772932585825113120, -358062306504992973, 859306555572411758, 10919653676974011, 388904134593412326, 45051907455286891, 505808926852488200, -25841804554750366, 1049930868366042488, 407190716491354479, 1429616762248534175, -543393482163143496, 1308722520072587426, -619074259246525917, 1050846951397200481, 1101013220645553239, 323970178805744544, -137232581783640350, 66892869010117976, 686315155591516335, 253532192053907011, 365919616763783727, 273191201103078903, 302803568027371002, 280715947186809376, -508730179950396114, 821000448832676501, -392525826932017150, 1038717181702828860, -543072283181536751, 113576731416170826, 57319993604567281, 221067403590399764, 277799628091871877, 155622475443093778, 246643120119522095, -58839955300221489, -448739446603943361, 776971498733719054, -175214339507761434, 1252374688384798639 };

static inline void mtoep9(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/4)

static inline void mmmtoep9(__int128* restrict rop, const __int128* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/4)

static inline void mmtoep9(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/4)

static inline void m1toep9(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1SCHOOLBOOK(N/4)


static inline void mtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP22TOP(N/2, mtoep9)

static inline void mmmtoep10(__int128* restrict rop, const __int128* restrict vect, const int64_t* restrict matr)
	MMTOEP22TOP(N/2, mmmtoep9)

static inline void mmtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	MTOEP22TOP(N/2, mmtoep9, mmmtoep9)

static inline void m1toep10(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP22TOP(N/2, m1toep9)


static inline void toeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP22TOP(N, mtoep10)

static inline void mtoeptop(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	MTOEP22TOP(N, mmtoep10, mmmtoep10)

static inline void m1toep20(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP22TOP(N, m1toep10)


static inline void mtoeplitz_vm(__int128* restrict rop, const int64_t* restrict vect)
{
	mtoeptop(rop, vect, M);
}


static inline void m1toeplitz_vm(int64_t* restrict rop, const __int128* restrict vect)
{
	int64_t v[N];
	for(int i = 0; i < N; i++)
		v[i] = vect[i];
	m1toep20(rop, v, M1);
}


static inline void mtoep127(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/4)


static inline void mtoep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	TOEP22TOP128(N/2, mtoep127)


void toep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	TOEP22TOP128(N, mtoep128)


static inline void bigtoep127(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/4)


static inline void bigtoep128(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	bigmatTOEP22TOP(N/2, bigtoep127)


void bigmattoep(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	bigmatTOEP22TOP(N, bigtoep128)

