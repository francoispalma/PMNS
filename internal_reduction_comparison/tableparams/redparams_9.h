#define N 9
#define LAMBDA 2
#define RHO 524593857961528536
#define RHOhi 524593857961528536
#define DIVBYRHO 54
#define LENGTH_OF_P 8

static const uint64_t __P__[8] = { 388409008156479707u, 16536770737060422227u, 14916896716645045849u, 17479061571897355016u, 3054940890737367049u, 7405717909275557051u, 12065049787536124420u, 11544241715714802378u };

static const uint64_t __invP__[8] = { 7375317753931950931u, 14858887821471293130u, 14356354951605845421u, 18174356851737777921u, 461681775721193782u, 14371953557907381084u, 4716059641720110113u, 14260947428639068264u };

static const int64_t M[17] = { 7412897899679506, -21942047849995486, -70228107284301320, 159640304655107992, 25998279584763672, -18093136157412372, 133084492036335100, 14644384783396064, 73550207710537025, 3706448949839753, -10971023924997743, -35114053642150660, 79820152327553996, 12999139792381836, -9046568078706186, 66542246018167550, 7322192391698032 };

static const int64_t Mhi[17] = { 0, -1, -1, 0, 0, -1, 0, 0, 0, 0, -1, -1, 0, 0, -1, 0, 0 };

static const uint64_t Mlo[17] = { 7412897899679506u, 18424802025859556130u, 18376515966425250296u, 159640304655107992u, 25998279584763672u, 18428650937552139244u, 133084492036335100u, 14644384783396064u, 73550207710537025u, 3706448949839753u, 18435773049784553873u, 18411630020067400956u, 79820152327553996u, 12999139792381836u, 18437697505630845430u, 66542246018167550u, 7322192391698032u };

static const int64_t M1[17] = { 1958459403974507966, 6688611242255415552, -5385346257053873102, 1258855572542099934, 1675382026404186936, -9051328137887805474, -2427859478678520614, -802485390780778668, -5794577387238989163, -8244142334867521825, 3344305621127707776, -2692673128526936551, -8593944250583725841, 837691013202093468, -4525664068943902737, 8009442297515515501, 8822129341464386474 };

static const int64_t M2hi[17] = { 6247365998124926109, 1380835510869325032, 381241204505680971, -772512329046462681, -623616804221364750, -1449614015774963659, -8415185094532559816, -4547987544399948322, 5228376408225223002, 3123682999062463054, -8532954281420113292, 190620602252840485, -386256164523231341, -311808402110682375, 8498565028967293978, 5015779489588495900, 6949378264654801647 };

static const uint64_t M2lo[17] = { 1958459403974507966u, 6688611242255415552u, 13061397816655678514u, 1258855572542099934u, 1675382026404186936u, 9395415935821746142u, 16018884595031031002u, 17644258682928772948u, 12652166686470562453u, 10202601738842029791u, 3344305621127707776u, 15754070945182615065u, 9852799823125825775u, 837691013202093468u, 13921080004765648879u, 8009442297515515501u, 8822129341464386474u };

static const int64_t Gprime[17] = { 1683557524303970106, 3545713704907670111, -628709346041637787, 634186789582845185, 2482342243823064496, -1901139049381415712, -1766481402650125695, -1003490803614541346, 1656786763854303380, 841778762151985053, 1772856852453835056, -314354673020818894, 317093394791422593, 1241171121911532248, -950569524690707856, -883240701325062848, -501745401807270673 };

static inline void mtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/3)

static inline void mmmtoep10(__int128* restrict rop, const __int128* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/3)

static inline void mmtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/3)

static inline void m1toep10(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1SCHOOLBOOK(N/3)


static inline void toeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP33TOP(N, mtoep10)

static inline void mtoeptop(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	MTOEP33TOP(N, mmtoep10, mmmtoep10)

static inline void m1toep20(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP33TOP(N, m1toep10)


static inline void mtoeplitz_vm(__int128* restrict rop, const int64_t* restrict vect)
{
	mtoeptop(rop, vect, M);
}


static inline void m1toeplitz_vm(int64_t* restrict rop, const __int128* restrict vect)
{
	int64_t v[N];
	for(int i = 0; i < N; i++)
		v[i] = vect[i];
	m1toep20(rop, v, M1);
}


static inline void mtoep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/3)


void toep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	TOEP33TOP128(N, mtoep128)


static inline void bigtoep128(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/3)


void bigmattoep(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	bigmatTOEP33TOP(N, bigtoep128)

