#define N 18
#define LAMBDA 2
#define RHO 924445461637196346
#define RHOhi 924445461637196346
#define DIVBYRHO 52
#define LENGTH_OF_P 16

static const uint64_t __P__[16] = { 16935962472486791375u, 9000750959947835848u, 1251655185792794477u, 7440320011828215518u, 4174738613080211191u, 4444496208983589072u, 6356343434823808404u, 15306132534395802467u, 11506475542803468337u, 1905275035687642070u, 5459749202013573388u, 3441243677801120770u, 15172238923182987779u, 1626763606730888041u, 7256570601494139918u, 10163597945766559067u };

static const uint64_t __invP__[16] = { 11227166666638499375u, 2819998801364013159u, 8199648617201053453u, 4429721044955374063u, 13994775131992824702u, 5253305958175136425u, 547744938706024093u, 5395104540113517247u, 1677066074804464255u, 17795269584517178378u, 15988320514497536604u, 16231808125395973047u, 16149122583400863295u, 5172097975128670085u, 16013018219893118357u, 2424948455757121626u };

static const int64_t M[35] = { -8274320046028224, 159761563834328834, -75469439321267102, 135403891276125868, -25882049483715124, 38777404198997428, -24091010586064154, 22433395263627924, 13491757901393718, 56802835018197508, -103773954317891394, -28090502663495558, -55315912610141586, -93002948152118756, 44665411441529222, -7803143546301612, 20334961602310806, -11070960373661529, -4137160023014112, 79880781917164417, -37734719660633551, 67701945638062934, -12941024741857562, 19388702099498714, -12045505293032077, 11216697631813962, 6745878950696859, 28401417509098754, -51886977158945697, -14045251331747779, -27657956305070793, -46501474076059378, 22332705720764611, -3901571773150806, 10167480801155403 };

static const int64_t Mhi[35] = { -1, 0, -1, 0, -1, 0, -1, 0, 0, 0, -1, -1, -1, -1, 0, -1, 0, -1, -1, 0, -1, 0, -1, 0, -1, 0, 0, 0, -1, -1, -1, -1, 0, -1, 0 };

static const uint64_t Mlo[35] = { 18438469753663523392u, 159761563834328834u, 18371274634388284514u, 135403891276125868u, 18420862024225836492u, 38777404198997428u, 18422653063123487462u, 22433395263627924u, 13491757901393718u, 56802835018197508u, 18342970119391660222u, 18418653571046056058u, 18391428161099410030u, 18353741125557432860u, 44665411441529222u, 18438940930163250004u, 20334961602310806u, 18435673113335890087u, 18442606913686537504u, 79880781917164417u, 18409009354048918065u, 67701945638062934u, 18433803048967694054u, 19388702099498714u, 18434698568416519539u, 11216697631813962u, 6745878950696859u, 28401417509098754u, 18394857096550605919u, 18432698822377803837u, 18419086117404480823u, 18400242599633492238u, 22332705720764611u, 18442842501936400810u, 10167480801155403u };

static const int64_t M1[35] = { 8232156706869504244, 1980090616602576634, -8074626986073278922, 4305920621062859678, 8202765632591690148, -3157154067134931800, -6612075428192590556, -4410604968030434744, 2725913697179752320, -6719712319997835886, 214951121371548678, 4516293915189516214, 4005464088217365550, -4345445352311051144, -8935048003972449816, -8956167414235595434, -5551808759907429900, 2706249260771208755, -5107293683420023686, -8233326728553487491, 5186058543818136347, -7070411726323345969, 4101382816295845074, -1578577033567465900, -3306037714096295278, 7018069552839558436, -7860415188264899648, 5863515876855857865, 107475560685774339, 2258146957594758107, -7220639992746093033, 7050649360699250236, -4467524001986224908, 4745288329736978091, 6447467656901060858 };

static const int64_t M2hi[35] = { 6079668487844149853, 1175072188873791901, -6305204111671656026, 6522816689764425957, -5304420418201896394, -3956966803579641301, -8596251976419628421, 5054745612002747164, -6123608312860937149, -5921175455865372158, -5626467839184613400, 3118162782894373180, 144471975616305379, 3374724857094797908, 6253436605029573639, -1867340041008420648, -2347815247854810164, 7129690175735490342, -6183537792932700882, 587536094436895950, 6070769981018947795, 3261408344882212978, 6571161827753827611, 7244888635064955157, -4298125988209814211, 2527372806001373582, -3061804156430468575, 6262784308922089729, -2813233919592306700, 1559081391447186590, 72235987808152689, -7536009608307376854, 3126718302514786819, -933670020504210324, -1173907623927405082 };

static const uint64_t M2lo[35] = { 8232156706869504244u, 1980090616602576634u, 10372117087636272694u, 4305920621062859678u, 8202765632591690148u, 15289590006574619816u, 11834668645516961060u, 14036139105679116872u, 2725913697179752320u, 11727031753711715730u, 214951121371548678u, 4516293915189516214u, 4005464088217365550u, 14101298721398500472u, 9511696069737101800u, 9490576659473956182u, 12894935313802121716u, 2706249260771208755u, 13339450390289527930u, 10213417345156064125u, 5186058543818136347u, 11376332347386205647u, 4101382816295845074u, 16868167040142085716u, 15140706359613256338u, 7018069552839558436u, 10586328885444651968u, 5863515876855857865u, 107475560685774339u, 2258146957594758107u, 11226104080963458583u, 7050649360699250236u, 13979220071723326708u, 4745288329736978091u, 6447467656901060858u };

static const int64_t Gprime[35] = { -3054722761681215051, -1451229317822873278, -1276750996660678295, -2813506631666641469, -2697634772862806135, -2454347208577253417, -2076839015461839300, -827659932111041737, -1522117077132677143, -2092751507680084171, -1454301645057296439, -1021915329951652143, -1602074912400138923, -1539643338157514636, -1788067738442151129, -882552417848527746, -692661708872326963, -1408841383331259816, -1527361380840607525, -725614658911436639, -638375498330339147, -1406753315833320735, -1348817386431403068, -1227173604288626709, -1038419507730919650, -413829966055520869, -761058538566338571, -1046375753840042085, -727150822528648219, -510957664975826071, -801037456200069462, -769821669078757318, -894033869221075564, -441276208924263873, -346330854436163481 };

static inline void mtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/3)

static inline void mmmtoep10(__int128* restrict rop, const __int128* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/3)

static inline void mmtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/3)

static inline void m1toep10(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1SCHOOLBOOK(N/3)


static inline void toeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP33TOP(N, mtoep10)

static inline void mtoeptop(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	MTOEP33TOP(N, mmtoep10, mmmtoep10)

static inline void m1toep20(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP33TOP(N, m1toep10)


static inline void mtoeplitz_vm(__int128* restrict rop, const int64_t* restrict vect)
{
	mtoeptop(rop, vect, M);
}


static inline void m1toeplitz_vm(int64_t* restrict rop, const __int128* restrict vect)
{
	int64_t v[N];
	for(int i = 0; i < N; i++)
		v[i] = vect[i];
	m1toep20(rop, v, M1);
}


static inline void mtoep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/3)


void toep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	TOEP33TOP128(N, mtoep128)


static inline void bigtoep128(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/3)


void bigmattoep(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	bigmatTOEP33TOP(N, bigtoep128)

