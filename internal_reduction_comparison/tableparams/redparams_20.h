#define N 20
#define LAMBDA 2
#define RHO 22061991659416968
#define RHOhi 22061991659416968
#define DIVBYRHO 48
#define LENGTH_OF_P 16

static const uint64_t __P__[16] = { 8202122055656926791u, 1867945544518244956u, 14354982478539492746u, 13477666793959132940u, 5287320423527047334u, 3986189421399578335u, 8733500238766952991u, 6102742848590749278u, 12139338162808772067u, 1260962477936499550u, 9103750739620659971u, 14512378318729015456u, 5606857037893146889u, 17568082745527332721u, 15939408052015373164u, 11540840893944363754u };

static const uint64_t __invP__[16] = { 7165351478896319351u, 17662304921940735701u, 7103635685881629825u, 8351325813105608710u, 8132962399555615083u, 4682515787487492039u, 18331120876495212423u, 17297683009233700785u, 13742263221601958589u, 9383086600586655354u, 9056317423599869827u, 2130591026523947448u, 9907659612413804491u, 18144189785871957971u, 13263755160787940217u, 13006598728574993841u };

static const int64_t M[39] = { -1969819343470640, -932969310181152, -1838801382731286, -570730536498540, 92472478437336, 706877943353082, -78812726869794, 242742460991740, -1056768992704230, -2357402025321684, 1271455574596870, 2869066410728172, 114331135153460, -775545572093596, 2863225328779794, -83324080005654, 1929357483718260, 1051157347313982, 1084278227825346, 172853298642351, -984909671735320, -466484655090576, -919400691365643, -285365268249270, 46236239218668, 353438971676541, -39406363434897, 121371230495870, -528384496352115, -1178701012660842, 635727787298435, 1434533205364086, 57165567576730, -387772786046798, 1431612664389897, -41662040002827, 964678741859130, 525578673656991, 542139113912673 };

static const int64_t Mhi[39] = { -1, -1, -1, -1, 0, 0, -1, 0, -1, -1, 0, 0, 0, -1, 0, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, 0, -1, 0, -1, -1, 0, 0, 0, -1, 0, -1, 0, 0, 0 };

static const uint64_t Mlo[39] = { 18444774254366080976u, 18445811104399370464u, 18444905272326820330u, 18446173343173053076u, 92472478437336u, 706877943353082u, 18446665260982681822u, 242742460991740u, 18445687304716847386u, 18444386671684229932u, 1271455574596870u, 2869066410728172u, 114331135153460u, 18445968528137458020u, 2863225328779794u, 18446660749629545962u, 1929357483718260u, 1051157347313982u, 1084278227825346u, 172853298642351u, 18445759164037816296u, 18446277589054461040u, 18445824673018185973u, 18446458708441302346u, 46236239218668u, 353438971676541u, 18446704667346116719u, 121371230495870u, 18446215689213199501u, 18445565372696890774u, 635727787298435u, 1434533205364086u, 57165567576730u, 18446356300923504818u, 1431612664389897u, 18446702411669548789u, 964678741859130u, 525578673656991u, 542139113912673u };

static const int64_t M1[39] = { -1499869699356308064, 7520372963049566360, -6917708303195578738, 4697444434786925564, -149207453429133476, -5078950174171392376, -2037795470161124294, 3277577211395929980, -5790729184310140804, -4714974458821558156, -8648553036553840454, 8194067205274205974, 8966892599791732746, -8246625449782000294, -6127666592552627316, -9161293210503895942, -5477767471618258260, -1069264071358981486, 2147594608419206710, 4945503342437777411, -749934849678154032, -5463185555329992628, -3458854151597789369, 2348722217393462782, 9148768310140209070, -2539475087085696188, -1018897735080562147, 1638788605697964990, 6328007444699705406, 6865884807443996730, 4899095518577855581, 4097033602637102987, 4483446299895866373, -4123312724891000147, -3063833296276313658, -4580646605251947971, -2738883735809129130, 8688740001175285065, -8149574732645172453 };

static const int64_t M2hi[39] = { -6532761653740446573, -3322310159789773933, 8305379715567826291, -8669949413262470738, -1732968157452685464, -5179401869743221951, -266091695470017669, 7164982999173878410, -9125755433161214834, -2968132063496299860, -8274702906964101534, -5425630181329345720, -1107513593920775674, -3864085445104289983, -6420739700328775033, -1425973170726472387, -4015583655705723665, -3241982895982394120, -6955341202019480577, 1129443338328615013, -3266380826870223287, 7562216956959888841, -5070682179070862663, 4888397330223540439, 8356887958128433076, -2589700934871610976, -133045847735008835, 3582491499586939205, -4562877716580607417, -1484066031748149930, -4137351453482050767, -2712815090664672860, 8669615239894387971, -1932042722552144992, -3210369850164387517, -712986585363236194, -2007791827852861833, 7602380588863578748, 5745701435845035519 };

static const uint64_t M2lo[39] = { 16946874374353243552u, 7520372963049566360u, 11529035770513972878u, 4697444434786925564u, 18297536620280418140u, 13367793899538159240u, 16408948603548427322u, 3277577211395929980u, 12656014889399410812u, 13731769614887993460u, 9798191037155711162u, 8194067205274205974u, 8966892599791732746u, 10200118623927551322u, 12319077481156924300u, 9285450863205655674u, 12968976602091293356u, 17377480002350570130u, 2147594608419206710u, 4945503342437777411u, 17696809224031397584u, 12983558518379558988u, 14987889922111762247u, 2348722217393462782u, 9148768310140209070u, 15907268986623855428u, 17427846338628989469u, 1638788605697964990u, 6328007444699705406u, 6865884807443996730u, 4899095518577855581u, 4097033602637102987u, 4483446299895866373u, 14323431348818551469u, 15382910777433237958u, 13866097468457603645u, 15707860337900422486u, 8688740001175285065u, 10297169341064379163u };

static const int64_t Gprime[39] = { 441376364345574532, 146375244269575025, 2312577470026042145, -519159524049811257, 1984003947157833757, -1056122201028612869, -128050589436553688, 1369125622005991849, 514034418702000632, -1181663012760190047, -243284809551782500, 58587412374419215, 834730298548736303, 421224200761662456, 234219017586897647, -261482804504381043, -113333880304628354, -84978339110501585, -403972104934718622, 62683147401884853, 220688182172787266, 73187622134787512, 1156288735013021073, -259579762024905628, 992001973578916879, -528061100514306435, -64025294718276844, 684562811002995925, 257017209351000316, -590831506380095024, -121642404775891250, 29293706187209608, 417365149274368151, 210612100380831228, 117109508793448824, -130741402252190522, -56666940152314177, -42489169555250792, -201986052467359311 };

static inline void mtoep9(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/4)

static inline void mmmtoep9(__int128* restrict rop, const __int128* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/4)

static inline void mmtoep9(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/4)

static inline void m1toep9(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1SCHOOLBOOK(N/4)


static inline void mtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP22TOP(N/2, mtoep9)

static inline void mmmtoep10(__int128* restrict rop, const __int128* restrict vect, const int64_t* restrict matr)
	MMTOEP22TOP(N/2, mmmtoep9)

static inline void mmtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	MTOEP22TOP(N/2, mmtoep9, mmmtoep9)

static inline void m1toep10(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP22TOP(N/2, m1toep9)


static inline void toeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP22TOP(N, mtoep10)

static inline void mtoeptop(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	MTOEP22TOP(N, mmtoep10, mmmtoep10)

static inline void m1toep20(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP22TOP(N, m1toep10)


static inline void mtoeplitz_vm(__int128* restrict rop, const int64_t* restrict vect)
{
	mtoeptop(rop, vect, M);
}


static inline void m1toeplitz_vm(int64_t* restrict rop, const __int128* restrict vect)
{
	int64_t v[N];
	for(int i = 0; i < N; i++)
		v[i] = vect[i];
	m1toep20(rop, v, M1);
}


static inline void mtoep127(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/4)


static inline void mtoep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	TOEP22TOP128(N/2, mtoep127)


void toep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	TOEP22TOP128(N, mtoep128)


static inline void bigtoep127(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/4)


static inline void bigtoep128(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	bigmatTOEP22TOP(N/2, bigtoep127)


void bigmattoep(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	bigmatTOEP22TOP(N, bigtoep128)

