#define N 42
#define LAMBDA 2
#define RHO 8639536652651458
#define RHOhi 8639536652651458
#define DIVBYRHO 46
#define LENGTH_OF_P 32

static const uint64_t __P__[32] = { 17307234776825139031u, 3026293106359475883u, 18245119254751204307u, 16819765713611223365u, 32593258627025758u, 10570410199085256631u, 3612953027730925158u, 3729989795098422964u, 2512117629649069679u, 4526050103279494900u, 4924432857529199761u, 12738914009580185485u, 16502857657446157160u, 14644645889161461345u, 5054839637122498671u, 3086598875406883475u, 9305162155412781297u, 10706122244993097086u, 1760889103728323475u, 4338415010770749367u, 8087978483297451532u, 3505722319169344847u, 15330979264854719462u, 4907888241943065544u, 11530268458071435470u, 12779465196739382143u, 1861001923548847126u, 7849369210836156729u, 14141072867356522271u, 18232641491092169451u, 1145121784618300381u, 11659947050468916823u };

static const uint64_t __invP__[32] = { 6577784337908976743u, 16507735766168521581u, 14390586181206474587u, 5484748738651961113u, 11947326927689944997u, 10328691271528204u, 15063720096089746089u, 6833775429821234340u, 15782335587427220939u, 6393386190574282015u, 12993557485258931171u, 2582497699703715753u, 393905978718105461u, 26825482147495528u, 10663212475866381564u, 16158761650548754395u, 11397218403781557316u, 3034903743976956687u, 18058464590922542288u, 6408180444146422258u, 4001882145991526561u, 8293389332756440849u, 16547552693814745856u, 5453652551571958991u, 4257140454943927067u, 17925651441305822522u, 7365277317384786282u, 15147377159456007455u, 1936968371896263127u, 7923579596699774611u, 3417522726909821805u, 128027355248192202u };

static const int64_t M[83] = { -237301777196422, -357549287710344, 206809437756760, -138462708771196, -253528912967984, 353498669219130, -141476348106914, 38285509154242, 55005807116178, -799069970908214, -1501675285082, -4891282495814, 99630009165690, 49837205052832, -90660802739282, 189925352227380, 60888319826632, 270002133196606, 31661578858948, -614163431655198, 106071645361026, -189070960671798, -912776030102404, 373421818832712, 331676804023590, 333410049698282, -329968580083502, -166385721985962, -26000027370230, -144648117743386, -107088847940034, -262912096461436, -214178055111880, 351526604892550, -322936517152694, -16809585493364, -221916638983094, 30557406143848, -26967337863562, 57883532206648, 87390239082164, -31789816036445, -118650888598211, -178774643855172, 103404718878380, -69231354385598, -126764456483992, 176749334609565, -70738174053457, 19142754577121, 27502903558089, -399534985454107, -750837642541, -2445641247907, 49815004582845, 24918602526416, -45330401369641, 94962676113690, 30444159913316, 135001066598303, 15830789429474, -307081715827599, 53035822680513, -94535480335899, -456388015051202, 186710909416356, 165838402011795, 166705024849141, -164984290041751, -83192860992981, -13000013685115, -72324058871693, -53544423970017, -131456048230718, -107089027555940, 175763302446275, -161468258576347, -8404792746682, -110958319491547, 15278703071924, -13483668931781, 28941766103324, 43695119541082 };

static const int64_t Mhi[83] = { -1, -1, 0, -1, -1, 0, -1, 0, 0, -1, -1, -1, 0, 0, -1, 0, 0, 0, 0, -1, 0, -1, -1, 0, 0, 0, -1, -1, -1, -1, -1, -1, -1, 0, -1, -1, -1, 0, -1, 0, 0, -1, -1, -1, 0, -1, -1, 0, -1, 0, 0, -1, -1, -1, 0, 0, -1, 0, 0, 0, 0, -1, 0, -1, -1, 0, 0, 0, -1, -1, -1, -1, -1, -1, -1, 0, -1, -1, -1, 0, -1, 0, 0 };

static const uint64_t Mlo[83] = { 18446506771932355194u, 18446386524421841272u, 206809437756760u, 18446605611000780420u, 18446490544796583632u, 353498669219130u, 18446602597361444702u, 38285509154242u, 55005807116178u, 18445945003738643402u, 18446742572034266534u, 18446739182427055802u, 99630009165690u, 49837205052832u, 18446653412906812334u, 189925352227380u, 60888319826632u, 270002133196606u, 31661578858948u, 18446129910277896418u, 106071645361026u, 18446555002748879818u, 18445831297679449212u, 373421818832712u, 331676804023590u, 333410049698282u, 18446414105129468114u, 18446577687987565654u, 18446718073682181386u, 18446599425591808230u, 18446636984861611582u, 18446481161613090180u, 18446529895654439736u, 351526604892550u, 18446421137192398922u, 18446727264124058252u, 18446522157070568522u, 30557406143848u, 18446717106371688054u, 57883532206648u, 87390239082164u, 18446712283893515171u, 18446625422820953405u, 18446565299065696444u, 103404718878380u, 18446674842355166018u, 18446617309253067624u, 176749334609565u, 18446673335535498159u, 19142754577121u, 27502903558089u, 18446344538724097509u, 18446743322871909075u, 18446741628068303709u, 49815004582845u, 24918602526416u, 18446698743308181975u, 94962676113690u, 30444159913316u, 135001066598303u, 15830789429474u, 18446436991993724017u, 53035822680513u, 18446649538229215717u, 18446287685694500414u, 186710909416356u, 165838402011795u, 166705024849141u, 18446579089419509865u, 18446660880848558635u, 18446731073695866501u, 18446671749650679923u, 18446690529285581599u, 18446612617661320898u, 18446636984681995676u, 175763302446275u, 18446582605450975269u, 18446735668916804934u, 18446633115390060069u, 15278703071924u, 18446730590040619835u, 28941766103324u, 43695119541082u };

static const int64_t M1[83] = { -733091186084305310, -2198333690704722114, -3683164330571670718, 659662070689546870, -5127622414214373922, 3989794291753463020, 6268599803140546648, 855611101767759698, -6112777877955876054, -4489537052680035700, 4808200644461918776, -8899135708061953420, -5931164109604866452, 119187029755061672, -6910638484924046146, 2249153337941281670, 3504021638464460944, -6049530608430672658, 5587415292230407874, 4131681662752896884, 4991392176286144388, -2597218187790641734, 6434024211737726108, 4044180829656815362, -443633509490864034, -7880886378721125332, -3698079480608387594, -7937836631147910754, 7999956503610208960, -2978098574799361814, 4138916181355825848, 4329880190201247810, 2835514071797488432, -7050949014193866134, -5556966011322677030, 7565418099412080304, 5669312127312342556, 5137545812060470992, -8110538332107610238, -976143169254978142, -4920386992076833270, -617243414646401517, 8856826443812623153, -1099166845352361057, -1841582165285835359, 329831035344773435, 6659560829747588847, -7228474890978044298, 3134299901570273324, -8795566485970895959, -3056388938977938027, -2244768526340017850, -6819271714623816420, -4449567854030976710, -2965582054802433226, 59593514877530836, -3455319242462023073, 1124576668970640835, 1752010819232230472, 6198606732639439479, 2793707646115203937, -7157531205478327366, 2495696088143072194, -1298609093895320867, 3217012105868863054, 2022090414828407681, -221816754745432017, 5282928847494213142, 7374332296550582011, 5254453721280820431, 3999978251805104480, 7734322749455094901, 2069458090677912924, 2164940095100623905, -7805615000956031592, 5697897529757842741, 6444889031193437293, -5440662987148735656, -6388715973198604530, -6654599130824540312, -4055269166053805119, 8735300452227286737, 6763178540816359173 };

static const int64_t M2hi[83] = { 653206793173655046, -3088039498250950391, -5564819849303022535, -2100779414839023562, -4606019506799486830, -1620013828382269485, 5760890572622879698, -7496665972133896673, -4052117129822911669, 7750533165705514027, -2757014583551566743, 3820153438770899643, 7655301361305414161, 6011482818361562394, -7934539449544920605, -2819077122731643350, 6740249818552547014, 2701390639956556778, 4832434803297748368, 3835473025391283973, 8183244305534767474, -5165188598165857617, -3536177132833039000, -2053177154893010124, -9169246700389423243, -7759911854133321692, 1331768037541975500, 3114939805903249040, -6029058461306700234, 7635569338347188160, 1403077735551093826, -4791102145085582372, 2217032574066291883, 3659255082123655706, 5437494927014223042, -2177722262461947041, -4149261522993235377, -2913759336933012099, 7064907996103679469, 2282760629168431850, 1133853906153091426, -8638165825715337058, 326603396586827523, -1544019749125475196, 6440962112203264540, -1050389707419511781, -2303009753399743415, 8413365122663641065, -6342926750543335959, 5475039050787827471, -2026058564911455835, 3875266582852757013, 7844864745078992436, -7313295317469325987, -5395721356202068728, -6217630627673994611, -3967269724772460303, 7813833475488954133, 3370124909276273507, -7872676716876497419, -6807154635205901624, 1917736512695641986, 4091622152767383737, 6640777737771846999, -1768088566416519500, 8196783459408270746, 4638748686660064186, -3879955927066660846, -8557488018083788058, -7665902133903151288, 6208842806201425691, 3817784669173594080, -8521833169079228895, -2395551072542791186, 1108516287033145941, -7393744495792947955, 2718747463507111521, 8134510905623802287, -2074630761496617689, 7766492368388269758, -5690918038802936074, 1141380314584215925, 566926953076545713 };

static const uint64_t M2lo[83] = { 17713652887625246306u, 16248410383004829502u, 14763579743137880898u, 659662070689546870u, 13319121659495177694u, 3989794291753463020u, 6268599803140546648u, 855611101767759698u, 12333966195753675562u, 13957207021029515916u, 4808200644461918776u, 9547608365647598196u, 12515579964104685164u, 119187029755061672u, 11536105588785505470u, 2249153337941281670u, 3504021638464460944u, 12397213465278878958u, 5587415292230407874u, 4131681662752896884u, 4991392176286144388u, 15849525885918909882u, 6434024211737726108u, 4044180829656815362u, 18003110564218687582u, 10565857694988426284u, 14748664593101164022u, 10508907442561640862u, 7999956503610208960u, 15468645498910189802u, 4138916181355825848u, 4329880190201247810u, 2835514071797488432u, 11395795059515685482u, 12889778062386874586u, 7565418099412080304u, 5669312127312342556u, 5137545812060470992u, 10336205741601941378u, 17470600904454573474u, 13526357081632718346u, 17829500659063150099u, 8856826443812623153u, 17347577228357190559u, 16605161908423716257u, 329831035344773435u, 6659560829747588847u, 11218269182731507318u, 3134299901570273324u, 9651177587738655657u, 15390355134731613589u, 16201975547369533766u, 11627472359085735196u, 13997176219678574906u, 15481162018907118390u, 59593514877530836u, 14991424831247528543u, 1124576668970640835u, 1752010819232230472u, 6198606732639439479u, 2793707646115203937u, 11289212868231224250u, 2495696088143072194u, 17148134979814230749u, 3217012105868863054u, 2022090414828407681u, 18224927318964119599u, 5282928847494213142u, 7374332296550582011u, 5254453721280820431u, 3999978251805104480u, 7734322749455094901u, 2069458090677912924u, 2164940095100623905u, 10641129072753520024u, 5697897529757842741u, 6444889031193437293u, 13006081086560815960u, 12058028100510947086u, 11792144942885011304u, 14391474907655746497u, 8735300452227286737u, 6763178540816359173u };

static const int64_t Gprime[83] = { -1276096858156384815, 2586828196081849552, -988990234371068987, 1588117225725470181, -2063914662905520434, 1285201971441432267, -1604441855986546250, -134537899561257505, -674028971165392568, -2228086921931595737, 725414937673612500, -2567043988742392741, 671214115543793029, -2068953272307293409, -231344965122449050, -1082726529035093982, 1324491173873562528, 234739303317937113, -1762011343618564047, 858280425749674850, -1216560658954491786, 1190587907544744049, -747615668720900493, 2246577103047196129, -183834799889533688, 984787843576117841, -108406959812571892, 1156727767078871942, 498115947133563506, -405310922958623193, 1030149768078437728, -1665758001587188040, 561655230907775476, -963022746480362257, 764474634682360807, -677435703780698742, 252316606139660697, -693458167889472030, 646512566557003464, 47953813592436455, -323221719230501493, 1354175292547382518, -638048429078192408, 1293414098040924776, -494495117185534494, 794058612862735090, -1031957331452760217, 642600985720716133, -802220927993273125, -67268949780628752, -337014485582696284, -1114043460965797868, 362707468836806250, -1283521994371196371, 335607057771896514, -1034476636153646704, -115672482561224525, -541363264517546991, 662245586936781264, 117369651658968556, -881005671809282024, 429140212874837425, -608280329477245893, 595293953772372025, -373807834360450247, 1123288551523598065, -91917399944766844, 492393921788058920, -54203479906285946, 578363883539435971, 249057973566781753, -202655461479311596, 515074884039218864, -832879000793594020, 280827615453887738, -481511373240181129, 382237317341180404, -338717851890349371, 126158303069830348, -346729083944736015, 323256283278501732, 23976906796218227, -161610859615250746 };

static inline void mtoep9(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/6)

static inline void mmmtoep9(__int128* restrict rop, const __int128* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/6)

static inline void mmtoep9(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/6)

static inline void m1toep9(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1SCHOOLBOOK(N/6)


static inline void mtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP33TOP(N/2, mtoep9)

static inline void mmmtoep10(__int128* restrict rop, const __int128* restrict vect, const int64_t* restrict matr)
	MMTOEP33TOP(N/2, mmmtoep9)

static inline void mmtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	MTOEP33TOP(N/2, mmtoep9, mmmtoep9)

static inline void m1toep10(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP33TOP(N/2, m1toep9)


static inline void toeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP22TOP(N, mtoep10)

static inline void mtoeptop(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	MTOEP22TOP(N, mmtoep10, mmmtoep10)

static inline void m1toep20(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP22TOP(N, m1toep10)


static inline void mtoeplitz_vm(__int128* restrict rop, const int64_t* restrict vect)
{
	mtoeptop(rop, vect, M);
}


static inline void m1toeplitz_vm(int64_t* restrict rop, const __int128* restrict vect)
{
	int64_t v[N];
	for(int i = 0; i < N; i++)
		v[i] = vect[i];
	m1toep20(rop, v, M1);
}


static inline void mtoep127(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/6)


static inline void mtoep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	TOEP33TOP128(N/2, mtoep127)


void toep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	TOEP22TOP128(N, mtoep128)


static inline void bigtoep127(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/6)


static inline void bigtoep128(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	bigmatTOEP33TOP(N/2, bigtoep127)


void bigmattoep(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	bigmatTOEP22TOP(N, bigtoep128)

