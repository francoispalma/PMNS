#define N 9
#define LAMBDA 2
#define RHO 524593857961528536
#define PHIOVER2G1 18
#define THETA 59

#define WRHOCARRE ((((__int128)253615388715344550)<<64) | (12847460892077893025u))
#define STEECONST 15
#define DTEECONST ((((__int128)6)<<64) | (14919308692513243136u))
#define LENGTH_OF_P 8

static const uint64_t __P__[8] = { 388409008156479707u, 16536770737060422227u, 14916896716645045849u, 17479061571897355016u, 3054940890737367049u, 7405717909275557051u, 12065049787536124420u, 11544241715714802378u };
static const uint64_t __Gi__[8][8] = {
{ 8368600174320697113u, 14183956230449595928u, 15130133613818926690u, 4561074313685492839u, 14542483098231494407u, 3327513517871699686u, 11331820134049366235u, 2126794770181733877u },
{ 8843486875749852422u, 17024957777001011601u, 7240228445813492804u, 4833362754759248411u, 5003395566097257263u, 2322409617038904599u, 7753346350778555453u, 6812770000143707359u },
{ 5682957287288082672u, 13843001375715618550u, 16006780043679739580u, 4278687267958865730u, 811012947131441574u, 8948046589196495642u, 3075105312953747563u, 7578545952639068404u },
{ 2110271810302898103u, 313118967843633526u, 13739452087353951237u, 13238696137582708065u, 2537659652411824509u, 11537503343487529204u, 2660947974917421871u, 3018084356378236662u },
{ 6748557996549195317u, 6547046950047262837u, 13369725951878422459u, 9177318796356175140u, 6183265867905908200u, 15372351471483000820u, 8710721198422929237u, 3002403806296924841u },
{ 16194782673914110601u, 15305024967314972400u, 8602104998819950400u, 11053883024170249841u, 13786026610237834943u, 743514971925155280u, 1057739762139134216u, 10044423495968981111u },
{ 4505709831705016914u, 7923839890185846530u, 9271863375088874326u, 367308627631088658u, 12513124661686644175u, 12551811080630038427u, 10548943047710083507u, 9516044179016808301u },
{ 244978711198774079u, 1347479478059713462u, 1754170115680200420u, 18015183395485376808u, 1396397821128101937u, 13875953609774656929u, 8154437202367359739u, 1143767174578855335u },
};


static const int64_t __Pi__[N][N] = {

		{-22917260318780537, 41881209535741133, 15311498205954128, 90903164238070801, 7144980679548133, 44661099958265729, -48624438629088844, -22662799055801022, 44873377615500238},

		{49093287371993629, -12962324708538903, 19465106964658436, 41497614148353663, -63196677755036115, 93433652050443049, 33979153205424786, 1424899398865841, 29813147335094335},

		{-3610017638838371, 235524702001606, -8720683970787347, 63103503504483522, 11506923885299392, -38757519423849166, 28688315077886457, -39725114562375550, -56447854384358564},

		{59258645107004067, 18614514173875426, -28726074067067129, -12941127816688561, 39426360317543197, -45576248616619819, -21159485361299992, 31368168238351981, 12867849717174498},

		{-4852808447753411, 52335390555764776, -11195050362370184, 16054791720463287, -66917064922616762, -30990632441403471, -22177468135342962, -84146931133851662, -50261816636392594},

		{10996929573473256, -27065408796704379, -10926651389054895, 49790255665278179, 52246609173107249, -48920808160019818, -32650137658946997, 19206386817528638, -16384552276581025},

		{47890015523813856, -47916823373121498, 548852795755907, 11647286618765480, -83032281012527642, -29532871998986243, 4758870013990494, 37260414869440953, -14034465361683055},

		{16350388173111248, 22206705213852531, 6338279968672961, -8381513010382347, -111048058357659051, 14183781592862030, 12349231437918590, 22646274768471577, -11345541720253426},

		{71211732160440584, 29444746676862023, -56730495753094277, -101635630851221233, -67715156948335582, 42343655935925769, -8683163165052048, 26232949042271965, 3586574418304237}
	};



static const int64_t M[17] = { 7412897899679506, -21942047849995486, -70228107284301320, 159640304655107992, 25998279584763672, -18093136157412372, 133084492036335100, 14644384783396064, 73550207710537025, 3706448949839753, -10971023924997743, -35114053642150660, 79820152327553996, 12999139792381836, -9046568078706186, 66542246018167550, 7322192391698032 };

static const int64_t M1[17] = { 1958459403974507966, 6688611242255415552, -5385346257053873102, 1258855572542099934, 1675382026404186936, -9051328137887805474, -2427859478678520614, -802485390780778668, -5794577387238989163, -8244142334867521825, 3344305621127707776, -2692673128526936551, -8593944250583725841, 837691013202093468, -4525664068943902737, 8009442297515515501, 8822129341464386474 };

static const int64_t G[N][N] = {

		{73550207710537025, 3706448949839753, -10971023924997743, -35114053642150660, 79820152327553996, 12999139792381836, -9046568078706186, 66542246018167550, 7322192391698032},

		{62778417992081919, -5978892075560720, -59957033289217018, 38271561014846479, -52155787977622737, 60842120459611440, -37911325418128996, -37317253082027257, 7064265648846781},

		{-14128531297693562, -62778417992081919, 5978892075560720, 59957033289217018, -38271561014846479, 52155787977622737, -60842120459611440, 37911325418128996, 37317253082027257},

		{-2272443125720967, -70928057214214761, 3157507372695819, 27664364349931259, 73841260251993276, -46957893496835182, 29224992936140293, 14386458040544813, 68164312851309472},

		{-14644384783396064, -73550207710537025, -3706448949839753, 10971023924997743, 35114053642150660, -79820152327553996, -12999139792381836, 9046568078706186, -66542246018167550},

		{-36222605373309027, 17332786876928328, -31686310578732379, 91106482071648868, 77771196686016544, 47822140893076245, -38202377959585247, 13347089364647678, -33131751212291255},

		{66263502424582510, 36222605373309027, -17332786876928328, 31686310578732379, -91106482071648868, -77771196686016544, -47822140893076245, 38202377959585247, -13347089364647678},

		{23311678952489048, 28270722710484639, 52834921056802389, 129926984663639281, -13019979566535195, -291052541456251, 50664342446674935, -40196016861138036, -49500511682695473},

		{-26694178729295356, 66263502424582510, 36222605373309027, -17332786876928328, 31686310578732379, -91106482071648868, -77771196686016544, -47822140893076245, 38202377959585247}
	};



static const int64_t G1[N][N] = {

		{7427532026267766883, 46585913157417255, 3128475071926821424, -8811927688296294169, 6640350190873974639, -1156011524065950250, 6713958166005660263, 3597494681261590904, 1030670481661439301},

		{4025136676200722109, -8250276815969624348, -2144390503422799378, 2097804590265382123, -6396861544606327582, 9207174390474126242, 125341042404510949, -5609679709212535338, 7744628647667099564},

		{-2207449291170742347, -5139021629987333969, -307448106650028326, 8557724922619652674, 3719491971466377455, -1304425827776410868, 1494941035568325810, -4305253881436124470, 7869969690071610513},

		{-5738541432484665884, 1978756313767807715, -5130304647000578808, -8177417796721638839, -8369325092467198756, -8455731600041357528, -6565543862295199645, 4150477718605233058, -9081833348069615293},

		{-8889926052324055376, -8093289436687514382, -5930285014836844200, 3951528701069036485, -3343291915584949409, 4862985974207649595, -909179125598578795, -712508255602416537, 2799366863344736678},

		{-8352556593710829044, 1533118805179345500, -1623802758840456356, -8729651878181580878, -6757451158040759562, -6855167034532102624, -7662352837552386273, 6142658778929686087, 1890187737746157883},

		{-82012982394663433, 3840818395503986178, 1980871691407268739, -3513990496586614239, -8203999742252564689, -2504980116857231358, 4964979296785944741, 8647638895786917445, -5772165099806228390},

		{-1082155854140277940, 2493821272937060281, 6852888886992068309, 7753036791213497129, -5690152117411564957, 6215804253340581146, 8277145216663459748, 2431834642446336299, -807185803020283649},

		{-5810740968104773179, -7079838840970606126, 8292848110760139377, 7660074690012351958, 274970051119994291, -2451131671944945009, -5408618450320297497, 4882966314391281308, 7469959413643176099}
	};



static const int64_t G2hi[N][N] = {

		{-5936241214895109752, 4429970550790238876, -5802640478968335166, 8882977039721107394, -315502821227847551, 1095250778520233227, 2510475541842377573, -4215239358465531107, -7335634429178032988},

		{1862845431770921957, -40058509959729653, -5962964500999936699, 1532993950209697822, -1399393214282923237, 2804892249484654330, 6240383650657799760, -7020131607950185438, -4825158887335655415},

		{-1892771722843034357, -2234997830175708854, 1177864123624010935, -1137805613664281284, -6688004319106577372, -3594365934897453260, 2020266637851001084, -3425765673052732179, 1415224763322144345},

		{6965423468764440433, 4881048946334606176, 2472358469873842262, -237360639698133410, 3307996486165178701, 6917749318228097720, 2179141171575308913, 8103229082428721717, 3435491401173145429},

		{-109865724690166682, -2432739851079867435, -3917916015035303010, -963132931299303167, -3529932067591295005, 7975734167420754989, 8093503354308308465, 127494915007966727, 5614632572748454343},

		{8181431709040446180, 606088711405881439, -6481455634845926830, 8914195485925794263, 5724498297438621024, -9017069725331782620, 4856377333540342283, 9144564640339749347, -4738608146652788807},

		{-1548910958165615569, 6996311137796880896, 1136758776787256583, -1742847488193138023, 5526704218016316628, 1160927010721607562, -4691066201724980190, 7983637629618141784, 117769186887553476},

		{-7151782519321901175, -8471957154136469747, -8015300727696584003, 1018989589899703106, 1666680145053169044, -5054171412962646680, -1278696197609161040, -5408935031128763152, -4573297014837426714},

		{-5220987569990892652, -6160673121505544458, -6532783206713924580, -3442003712859157290, 2578485504484474461, 831042128761832605, -8819275645909478224, -6239977159890595758, -5851993212446587753}
	};



static const uint64_t G2lo[N][N] = {

		{7427532026267766883u, 46585913157417255u, 3128475071926821424u, 9634816385413257447u, 6640350190873974639u, 17290732549643601366u, 6713958166005660263u, 3597494681261590904u, 1030670481661439301u},

		{4025136676200722109u, 10196467257739927268u, 16302353570286752238u, 2097804590265382123u, 12049882529103224034u, 9207174390474126242u, 125341042404510949u, 12837064364497016278u, 7744628647667099564u},

		{16239294782538809269u, 13307722443722217647u, 18139295967059523290u, 8557724922619652674u, 3719491971466377455u, 17142318245933140748u, 1494941035568325810u, 14141490192273427146u, 7869969690071610513u},

		{12708202641224885732u, 1978756313767807715u, 13316439426708972808u, 10269326276987912777u, 10077418981242352860u, 9991012473668194088u, 11881200211414351971u, 4150477718605233058u, 9364910725639936323u},

		{9556818021385496240u, 10353454637022037234u, 12516459058872707416u, 3951528701069036485u, 15103452158124602207u, 4862985974207649595u, 17537564948110972821u, 17734235818107135079u, 2799366863344736678u},

		{10094187479998722572u, 1533118805179345500u, 16822941314869095260u, 9717092195527970738u, 11689292915668792054u, 11591577039177448992u, 10784391236157165343u, 6142658778929686087u, 1890187737746157883u},

		{18364731091314888183u, 3840818395503986178u, 1980871691407268739u, 14932753577122937377u, 10242744331456986927u, 15941763956852320258u, 4964979296785944741u, 8647638895786917445u, 12674578973903323226u},

		{17364588219569273676u, 2493821272937060281u, 6852888886992068309u, 7753036791213497129u, 12756591956297986659u, 6215804253340581146u, 8277145216663459748u, 2431834642446336299u, 17639558270689267967u},

		{12636003105604778437u, 11366905232738945490u, 8292848110760139377u, 7660074690012351958u, 274970051119994291u, 15995612401764606607u, 13038125623389254119u, 4882966314391281308u, 7469959413643176099u}
	};



static const int64_t Gprime[N][N] = {

		{128, 94, 0, -3, 26, -83, -7, 68, 23},

		{-6, -48, -71, -23, -105, 71, 60, -3, 16},

		{98, -75, 136, -87, 22, -124, -87, 121, 76},

		{-34, 3, 15, 60, -23, 67, 48, 54, -11},

		{72, 11, -29, 26, 23, 42, -56, 12, 37},

		{41, 22, 56, -67, -35, -3, -79, 15, -19},

		{-51, -44, -97, 75, -60, -1, 22, 15, -98},

		{37, -136, 44, 1, -47, 54, 99, -38, -76},

		{-28, 7, 16, 120, -113, -9, 23, -29, 23}
	};



static inline void mtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/3)

static inline void mmmtoep10(__int128* restrict rop, const __int128* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/3)

static inline void mmtoep10(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	SCHOOLBOOK(N/3)

static inline void m1toep10(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1SCHOOLBOOK(N/3)


static inline void toeplitz_vm(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	TOEP33TOP(N, mtoep10)

static inline void mtoeptop(__int128* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	MTOEP33TOP(N, mmtoep10, mmmtoep10)

static inline void m1toep20(int64_t* restrict rop, const int64_t* restrict vect, const int64_t* restrict matr)
	M1TOEP33TOP(N, m1toep10)


static inline void mtoeplitz_vm(__int128* restrict rop, const int64_t* restrict vect)
{
	mtoeptop(rop, vect, M);
}


static inline void m1toeplitz_vm(int64_t* restrict rop, const __int128* restrict vect)
{
	int64_t v[N];
	for(int i = 0; i < N; i++)
		v[i] = vect[i];
	m1toep20(rop, v, M1);
}


static inline void mtoep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/3)


void toep128(__int128* restrict rop, const __int128* restrict vect, const __int128* restrict matr)
	TOEP33TOP128(N, mtoep128)


static inline void bigtoep128(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	SCHOOLBOOK(N/3)


void bigmattoep(__int128* restrict rop, const int64_t* restrict vect, const __int128* restrict matr)
	bigmatTOEP33TOP(N, bigtoep128)

